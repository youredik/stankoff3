# Будущий план развития (Фаза 3+)

**Дата создания:** Февраль 2026
**Последнее обновление:** Февраль 2026
**Статус:** Отложено до стабилизации текущего функционала

---

## 1. Фаза 3: Новые модули

### 3.1 KnowledgeBaseModule (Wiki)

Внутренняя база знаний для сотрудников.

**Функционал:**
- [ ] Создание и редактирование статей (Tiptap editor)
- [ ] Иерархическая структура (категории, подкатегории)
- [ ] Версионирование статей
- [ ] Полнотекстовый поиск
- [ ] Связывание статей с товарами/оборудованием
- [ ] Права доступа по ролям
- [ ] Интеграция с AI (RAG для поиска по базе знаний)

**Технические задачи:**
- [ ] Entity: KnowledgeArticle (title, content, categoryId, authorId, version, publishedAt)
- [ ] Entity: KnowledgeCategory (name, parentId, order)
- [ ] Controller + Service для CRUD
- [ ] Индексация в pgvector для RAG
- [ ] UI: список статей, редактор, просмотр

### 3.2 ReportsModule (PDF/Excel)

Генерация отчётов по заявкам и активности.

**Типы отчётов:**
- [ ] Отчёт по заявкам за период (PDF/Excel)
- [ ] Отчёт по исполнителям (нагрузка, время реакции)
- [ ] Отчёт по SLA (выполнение/нарушения)
- [ ] Отчёт по AI использованию (токены, стоимость)

**Технические задачи:**
- [ ] Библиотека для PDF (pdfkit или puppeteer)
- [ ] Библиотека для Excel (exceljs)
- [ ] Шаблоны отчётов
- [ ] Эндпоинты для генерации
- [ ] UI: выбор периода, типа отчёта, скачивание

### 3.3 NotificationsModule (Push/Email/Telegram)

Система уведомлений о событиях.

**Каналы:**
- [ ] Email уведомления (уже есть EmailService)
- [ ] Push уведомления (Web Push API)
- [ ] Telegram бот для сотрудников

**События:**
- [ ] Новая заявка
- [ ] Назначение на заявку
- [ ] Комментарий в заявке
- [ ] Изменение статуса
- [ ] Нарушение SLA
- [ ] Напоминания

**Технические задачи:**
- [ ] Entity: NotificationPreference (userId, channel, events)
- [ ] Entity: Notification (userId, type, data, readAt)
- [ ] Service для отправки по каналам
- [ ] Telegram Bot (node-telegram-bot-api)
- [ ] UI: настройки уведомлений, история

---

## 2. Индексация документов из Legacy

### 2.1 Источники документов
- Техническая документация оборудования (PDF)
- Инструкции по эксплуатации (PDF, Word)
- Сервисные мануалы
- Схемы и чертежи

### 2.2 Задачи
- [ ] Интеграция с файловым хранилищем Legacy (путь к документам)
- [ ] Парсинг PDF (pdf-parse или PyMuPDF через микросервис)
- [ ] Парсинг Word документов (mammoth)
- [ ] OCR для сканированных документов (Tesseract)
- [ ] Chunking с учётом структуры документа (заголовки, разделы)
- [ ] Связывание документов с товарами (по артикулу/названию)
- [ ] Индексация в pgvector с метаданными (источник, товар, тип)
- [ ] UI для просмотра источников в RAG ответах

### 2.3 Оценка
- **Сложность:** Высокая (разные форматы, качество документов)
- **Приоритет:** После стабилизации основного AI функционала

---

## 3. Фаза 4: Масштабирование и Production

### 3.1 Инфраструктура Production
- [ ] Отдельный production сервер или Managed Kubernetes (Yandex Cloud)
- [ ] Репликация PostgreSQL (primary + read replica)
- [ ] Redis для:
  - Сессии пользователей
  - Кэширование Legacy данных
  - Rate limiting AI запросов
  - Очереди задач (Bull)
- [ ] Load Balancer для горизонтального масштабирования

### 3.2 Мониторинг и логирование
- [ ] Централизованное логирование (ELK Stack или Grafana Loki)
- [ ] APM (Application Performance Monitoring):
  - Sentry для ошибок
  - Datadog или Grafana для метрик
- [ ] Алерты:
  - Downtime сервисов
  - Превышение SLA
  - Ошибки AI провайдеров
  - Высокая нагрузка

### 3.3 Backup и Disaster Recovery
- [ ] Автоматический backup PostgreSQL (pg_dump + S3)
- [ ] Point-in-time recovery (WAL archiving)
- [ ] Тестирование restore процедуры (ежемесячно)
- [ ] Документирование DR плана
- [ ] RTO/RPO метрики

### 3.4 Безопасность
- [ ] Аудит безопасности (OWASP)
- [ ] Penetration testing
- [ ] Ротация секретов
- [ ] IP whitelisting для админских эндпоинтов
- [ ] 2FA для администраторов

### 3.5 Оптимизация производительности
- [ ] Профилирование медленных запросов
- [ ] Оптимизация индексов PostgreSQL
- [ ] CDN для статики (Yandex CDN)
- [ ] Сжатие ответов (Brotli)
- [ ] HTTP/2 или HTTP/3

---

## 4. Расширение на другие отделы

После стабилизации Сервиса (техподдержка, рекламации):

### 4.1 Продажи
- Воронка продаж с интеграцией Legacy deal
- Автоматизация follow-up
- AI скоринг лидов

### 4.2 Логистика
- Отслеживание доставок
- Интеграция с транспортными компаниями
- Оптимизация маршрутов

### 4.3 Установка/Наладка
- Календарь выездов
- Чек-листы работ
- Фотофиксация

### 4.4 Бухгалтерия
- Интеграция с 1С
- Автоматическое формирование актов
- Сверка платежей

---

## 5. Клиентский портал (v3.0)

### 5.1 Функционал для клиентов
- [ ] Личный кабинет клиента
- [ ] История заявок и статусы
- [ ] Чат-бот для первичной обработки
- [ ] База знаний (FAQ)
- [ ] Создание заявок через форму
- [ ] Оценка качества обслуживания

### 5.2 Интеграции
- [ ] Telegram бот для клиентов
- [ ] WhatsApp Business API
- [ ] Email-to-ticket

---

## 6. Метрики успеха (KPI)

| Метрика | Текущее | Цель |
|---------|---------|------|
| Время ответа на заявку | ? | < 2 часов |
| Время решения | ? | < 24 часов |
| Автоклассификация accuracy | ? | > 85% |
| AI ответы принятые | ? | > 60% |
| Uptime | 99% | 99.9% |
| Удовлетворённость клиентов | ? | > 4.5/5 |

---

## Приоритеты

1. **Высокий:** Фаза 3 (Wiki, Отчёты, Уведомления)
2. **Средний:** Production инфраструктура, backup, мониторинг
3. **Низкий:** Клиентский портал, другие отделы, индексация документов

---

*Этот план будет актуализирован по мере развития проекта*
