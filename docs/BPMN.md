# Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° BPMN-Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ñ‹

**Ğ”Ğ°Ñ‚Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ:** 2026-02-04
**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
**Ğ’ĞµÑ€ÑĞ¸Ñ:** 1.0

---

## Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ğµ

1. [ĞĞ±Ğ·Ğ¾Ñ€ Ğ¸ Ñ†ĞµĞ»Ğ¸](#1-Ğ¾Ğ±Ğ·Ğ¾Ñ€-Ğ¸-Ñ†ĞµĞ»Ğ¸)
2. [Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²](#2-Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹-Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°-Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²)
3. [Human Tasks (ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸)](#3-human-tasks-Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ğµ-Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸)
4. [Ğ¤Ğ¾Ñ€Ğ¼Ñ‹ Ğ¸ UI Ğ´Ğ»Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡](#4-Ñ„Ğ¾Ñ€Ğ¼Ñ‹-Ğ¸-ui-Ğ´Ğ»Ñ-Ğ·Ğ°Ğ´Ğ°Ñ‡)
5. [SLA Ğ¸ Ğ´ĞµĞ´Ğ»Ğ°Ğ¹Ğ½Ñ‹](#5-sla-Ğ¸-Ğ´ĞµĞ´Ğ»Ğ°Ğ¹Ğ½Ñ‹)
6. [Business Rules Engine (DMN)](#6-business-rules-engine-dmn)
7. [Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ñ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğ¼Ğ¸ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°Ğ¼Ğ¸](#7-Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸-Ñ-Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğ¼Ğ¸-ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°Ğ¼Ğ¸)
8. [Ğ’ĞµÑ€ÑĞ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ](#8-Ğ²ĞµÑ€ÑĞ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ-Ğ¸-Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ)
9. [ĞšĞ¾Ğ¼Ğ¿ĞµĞ½ÑĞ°Ñ†Ğ¸Ğ¸ Ğ¸ Ğ¾Ñ‚ĞºĞ°Ñ‚](#9-ĞºĞ¾Ğ¼Ğ¿ĞµĞ½ÑĞ°Ñ†Ğ¸Ğ¸-Ğ¸-Ğ¾Ñ‚ĞºĞ°Ñ‚)
10. [ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ğ¸ Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚Ñ‹](#10-Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°-Ğ¸-Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚Ñ‹)
11. [Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½Ñ‹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²](#11-ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ñ‹-Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²)
12. [ĞŸÑ€Ğ°Ğ²Ğ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°](#12-Ğ¿Ñ€Ğ°Ğ²Ğ°-Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°)
13. [AI/ML Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ](#13-aiml-Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ)
14. [ĞšÑ€Ğ¾ÑÑ-workspace Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ](#14-ĞºÑ€Ğ¾ÑÑ-workspace-Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ)
15. [ĞŸĞ»Ğ°Ğ½ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸](#15-Ğ¿Ğ»Ğ°Ğ½-Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸)

---

## 1. ĞĞ±Ğ·Ğ¾Ñ€ Ğ¸ Ñ†ĞµĞ»Ğ¸

### 1.1 Ğ¢ĞµĞºÑƒÑ‰ĞµĞµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾ (MVP)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… BPMN Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¾Ñ€ (bpmn-js)                                      â”‚
â”‚ âœ… Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² Ğ² Zeebe                                     â”‚
â”‚ âœ… Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ                                     â”‚
â”‚ âœ… Service Tasks (6 workers)                                    â”‚
â”‚ âœ… Ğ¢ĞµĞ¿Ğ»Ğ¾Ğ²Ğ°Ñ ĞºĞ°Ñ€Ñ‚Ğ°                                               â”‚
â”‚ âœ… Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°                                           â”‚
â”‚ âœ… Ğ¥Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ definitions Ğ¸ instances Ğ² PostgreSQL                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Ğ¦ĞµĞ»ĞµĞ²Ğ¾Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ĞŸĞ¾Ğ»Ğ½Ğ¾Ñ†ĞµĞ½Ğ½Ğ°Ñ BPM-Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğ°                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹   â”‚    â”‚   Human     â”‚    â”‚    DMN      â”‚         â”‚
â”‚  â”‚  (ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ,  â”‚    â”‚   Tasks     â”‚    â”‚  (Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°)  â”‚         â”‚
â”‚  â”‚   Ñ‚Ğ°Ğ¹Ğ¼ĞµÑ€Ñ‹)  â”‚    â”‚  + Ñ„Ğ¾Ñ€Ğ¼Ñ‹    â”‚    â”‚             â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚         â”‚                  â”‚                  â”‚                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                            â–¼                                    â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚              â”‚      BPMN Engine        â”‚                        â”‚
â”‚              â”‚       (Zeebe)           â”‚                        â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                            â”‚                                    â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚         â–¼                  â–¼                  â–¼                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸  â”‚    â”‚    SLA      â”‚    â”‚  Analytics  â”‚         â”‚
â”‚  â”‚ (Telegram,  â”‚    â”‚  Ğ¢Ğ°Ğ¹Ğ¼ĞµÑ€Ñ‹    â”‚    â”‚  Process    â”‚         â”‚
â”‚  â”‚  Email, 1C) â”‚    â”‚  Ğ­ÑĞºĞ°Ğ»Ğ°Ñ†Ğ¸Ñ  â”‚    â”‚  Mining     â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 ĞŸÑ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹

1. **ĞœĞ¾Ğ´ÑƒĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ** â€” ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ» Ğ² Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ¾Ğ¼ Ğ¼Ğ¾Ğ´ÑƒĞ»Ğµ
2. **Event-driven** â€” Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ Ñ‡ĞµÑ€ĞµĞ· ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ
3. **Backward compatible** â€” Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ» Ğ½Ğµ Ğ»Ğ¾Ğ¼Ğ°ĞµÑ‚ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹
4. **Configurable** â€” Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ñ‡ĞµÑ€ĞµĞ· UI, Ğ½Ğµ ĞºĞ¾Ğ´
5. **Scalable** â€” Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğº Ñ€Ğ¾ÑÑ‚Ñƒ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸

---

## 2. Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²

### 2.1 Ğ¢Ğ¸Ğ¿Ñ‹ Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ğ¾Ğ²

| Ğ¢Ğ¸Ğ¿ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ |
|-----|----------|-----------|
| Entity Events | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ, Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°, Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ | ğŸ”´ Ğ’Ñ‹ÑĞ¾ĞºĞ¸Ğ¹ |
| Timer/Cron | ĞŸĞ¾ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ | ğŸŸ¡ Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹ |
| Webhook | Ğ’Ğ½ĞµÑˆĞ½Ğ¸Ğµ HTTP Ğ²Ñ‹Ğ·Ğ¾Ğ²Ñ‹ | ğŸŸ¡ Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹ |
| Message | Zeebe messages | ğŸŸ¢ ĞĞ¸Ğ·ĞºĞ¸Ğ¹ |
| Manual | Ğ ÑƒÑ‡Ğ½Ğ¾Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº (ÑƒĞ¶Ğµ ĞµÑÑ‚ÑŒ) | âœ… Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾ |

### 2.2 ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```sql
-- Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ğ¾Ğ² Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²
CREATE TABLE process_triggers (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  process_definition_id UUID NOT NULL REFERENCES process_definitions(id) ON DELETE CASCADE,
  workspace_id UUID NOT NULL REFERENCES workspaces(id) ON DELETE CASCADE,

  -- Ğ¢Ğ¸Ğ¿ Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ğ°
  trigger_type VARCHAR(50) NOT NULL, -- 'entity_created', 'status_changed', 'cron', 'webhook'

  -- Ğ£ÑĞ»Ğ¾Ğ²Ğ¸Ñ ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ (JSONB Ğ´Ğ»Ñ Ğ³Ğ¸Ğ±ĞºĞ¾ÑÑ‚Ğ¸)
  conditions JSONB NOT NULL DEFAULT '{}',
  -- ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹:
  -- entity_created: { "entityTypes": ["ticket", "request"] }
  -- status_changed: { "fromStatus": "new", "toStatus": "in_progress" }
  -- cron: { "expression": "0 9 * * 1-5", "timezone": "Europe/Moscow" }
  -- webhook: { "secret": "xxx", "allowedIps": ["1.2.3.4"] }

  -- ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‡Ğ¸ Ğ² Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ
  variable_mappings JSONB DEFAULT '{}',
  -- { "entityId": "$.entity.id", "priority": "$.entity.priority" }

  -- Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ
  is_active BOOLEAN DEFAULT true,
  last_triggered_at TIMESTAMPTZ,
  trigger_count INT DEFAULT 0,

  -- ĞœĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
  name VARCHAR(255),
  description TEXT,
  created_by_id UUID REFERENCES users(id),
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹
CREATE INDEX idx_process_triggers_workspace ON process_triggers(workspace_id);
CREATE INDEX idx_process_triggers_type ON process_triggers(trigger_type) WHERE is_active = true;
CREATE INDEX idx_process_triggers_definition ON process_triggers(process_definition_id);

-- Ğ›Ğ¾Ğ³ ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğ¹ Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ğ¾Ğ²
CREATE TABLE trigger_executions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  trigger_id UUID NOT NULL REFERENCES process_triggers(id) ON DELETE CASCADE,
  process_instance_id UUID REFERENCES process_instances(id),

  -- ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ
  trigger_context JSONB NOT NULL, -- Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ, Ğ²Ñ‹Ğ·Ğ²Ğ°Ğ²ÑˆĞ¸Ğµ Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€

  -- Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚
  status VARCHAR(50) NOT NULL, -- 'success', 'failed', 'skipped'
  error_message TEXT,

  executed_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_trigger_executions_trigger ON trigger_executions(trigger_id);
CREATE INDEX idx_trigger_executions_date ON trigger_executions(executed_at);
```

### 2.3 Backend: TriggerModule

```
apps/backend/src/modules/bpmn/triggers/
â”œâ”€â”€ triggers.module.ts
â”œâ”€â”€ triggers.service.ts
â”œâ”€â”€ triggers.controller.ts
â”œâ”€â”€ dto/
â”‚   â”œâ”€â”€ create-trigger.dto.ts
â”‚   â””â”€â”€ update-trigger.dto.ts
â”œâ”€â”€ listeners/
â”‚   â”œâ”€â”€ entity-event.listener.ts      # Ğ¡Ğ»ÑƒÑˆĞ°ĞµÑ‚ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ entities
â”‚   â”œâ”€â”€ cron-trigger.scheduler.ts     # ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ñ‰Ğ¸Ğº cron
â”‚   â””â”€â”€ webhook-trigger.controller.ts # HTTP endpoint Ğ´Ğ»Ñ webhooks
â””â”€â”€ interfaces/
    â””â”€â”€ trigger.interface.ts
```

#### triggers.service.ts

```typescript
@Injectable()
export class TriggersService {
  constructor(
    @InjectRepository(ProcessTrigger)
    private triggerRepository: Repository<ProcessTrigger>,
    @InjectRepository(TriggerExecution)
    private executionRepository: Repository<TriggerExecution>,
    private bpmnService: BpmnService,
  ) {}

  // ==================== CRUD ====================

  async create(dto: CreateTriggerDto, userId: string): Promise<ProcessTrigger> {
    const trigger = this.triggerRepository.create({
      ...dto,
      createdById: userId,
    });
    return this.triggerRepository.save(trigger);
  }

  async findByWorkspace(workspaceId: string): Promise<ProcessTrigger[]> {
    return this.triggerRepository.find({
      where: { workspaceId },
      relations: ['processDefinition'],
      order: { createdAt: 'DESC' },
    });
  }

  // ==================== Trigger Evaluation ====================

  async evaluateTriggers(
    triggerType: TriggerType,
    context: Record<string, any>,
    workspaceId: string,
  ): Promise<void> {
    const triggers = await this.triggerRepository.find({
      where: {
        workspaceId,
        triggerType,
        isActive: true,
      },
      relations: ['processDefinition'],
    });

    for (const trigger of triggers) {
      const shouldFire = this.evaluateConditions(trigger.conditions, context);

      if (shouldFire) {
        await this.fireTrigger(trigger, context);
      }
    }
  }

  private evaluateConditions(
    conditions: Record<string, any>,
    context: Record<string, any>,
  ): boolean {
    // ĞŸÑ€Ğ¾ÑÑ‚Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ğ¹
    // ĞœĞ¾Ğ¶Ğ½Ğ¾ Ñ€Ğ°ÑÑˆĞ¸Ñ€Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ JSONPath Ğ¸Ğ»Ğ¸ Ğ²Ñ‹Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹

    if (conditions.fromStatus && context.oldStatus !== conditions.fromStatus) {
      return false;
    }
    if (conditions.toStatus && context.newStatus !== conditions.toStatus) {
      return false;
    }
    if (conditions.priority && context.priority !== conditions.priority) {
      return false;
    }

    return true;
  }

  private async fireTrigger(
    trigger: ProcessTrigger,
    context: Record<string, any>,
  ): Promise<void> {
    const execution = this.executionRepository.create({
      triggerId: trigger.id,
      triggerContext: context,
      status: 'pending',
    });

    try {
      // ĞœĞ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ñ…
      const variables = this.mapVariables(trigger.variableMappings, context);

      // Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ°
      const instance = await this.bpmnService.startProcess(
        trigger.processDefinitionId,
        variables,
        { entityId: context.entityId },
      );

      execution.processInstanceId = instance.id;
      execution.status = 'success';

      // ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑÑ‡Ñ‘Ñ‚Ñ‡Ğ¸Ğº
      await this.triggerRepository.update(trigger.id, {
        lastTriggeredAt: new Date(),
        triggerCount: () => 'trigger_count + 1',
      });

    } catch (error) {
      execution.status = 'failed';
      execution.errorMessage = error.message;
    }

    await this.executionRepository.save(execution);
  }

  private mapVariables(
    mappings: Record<string, string>,
    context: Record<string, any>,
  ): Record<string, any> {
    const result: Record<string, any> = {};

    for (const [key, path] of Object.entries(mappings)) {
      // ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ğ¹ JSONPath: $.entity.id -> context.entity.id
      const value = this.resolvePath(path, context);
      if (value !== undefined) {
        result[key] = value;
      }
    }

    return result;
  }

  private resolvePath(path: string, obj: Record<string, any>): any {
    if (!path.startsWith('$.')) return path; // literal value

    const parts = path.slice(2).split('.');
    let current = obj;

    for (const part of parts) {
      if (current === null || current === undefined) return undefined;
      current = current[part];
    }

    return current;
  }
}
```

#### entity-event.listener.ts

```typescript
@Injectable()
export class EntityEventListener {
  constructor(private triggersService: TriggersService) {}

  @OnEvent('entity.created')
  async handleEntityCreated(payload: {
    entity: Entity;
    userId: string;
  }) {
    await this.triggersService.evaluateTriggers(
      'entity_created',
      {
        entityId: payload.entity.id,
        workspaceId: payload.entity.workspaceId,
        title: payload.entity.title,
        status: payload.entity.status,
        priority: payload.entity.priority,
        createdById: payload.userId,
      },
      payload.entity.workspaceId,
    );
  }

  @OnEvent('entity.status_changed')
  async handleStatusChanged(payload: {
    entity: Entity;
    oldStatus: string;
    newStatus: string;
    userId: string;
  }) {
    await this.triggersService.evaluateTriggers(
      'status_changed',
      {
        entityId: payload.entity.id,
        workspaceId: payload.entity.workspaceId,
        oldStatus: payload.oldStatus,
        newStatus: payload.newStatus,
        changedById: payload.userId,
      },
      payload.entity.workspaceId,
    );
  }

  @OnEvent('entity.assignee_changed')
  async handleAssigneeChanged(payload: {
    entity: Entity;
    oldAssigneeId: string | null;
    newAssigneeId: string | null;
    userId: string;
  }) {
    await this.triggersService.evaluateTriggers(
      'assignee_changed',
      {
        entityId: payload.entity.id,
        workspaceId: payload.entity.workspaceId,
        oldAssigneeId: payload.oldAssigneeId,
        newAssigneeId: payload.newAssigneeId,
        assignedById: payload.userId,
      },
      payload.entity.workspaceId,
    );
  }
}
```

#### cron-trigger.scheduler.ts

```typescript
@Injectable()
export class CronTriggerScheduler implements OnModuleInit {
  private scheduledJobs: Map<string, ScheduledTask> = new Map();

  constructor(
    @InjectRepository(ProcessTrigger)
    private triggerRepository: Repository<ProcessTrigger>,
    private triggersService: TriggersService,
  ) {}

  async onModuleInit() {
    await this.loadCronTriggers();
  }

  async loadCronTriggers() {
    const cronTriggers = await this.triggerRepository.find({
      where: { triggerType: 'cron', isActive: true },
    });

    for (const trigger of cronTriggers) {
      this.scheduleTrigger(trigger);
    }
  }

  scheduleTrigger(trigger: ProcessTrigger) {
    const cronExpression = trigger.conditions.expression;
    const timezone = trigger.conditions.timezone || 'Europe/Moscow';

    // ĞÑ‚Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹ job ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ
    this.unscheduleTrigger(trigger.id);

    const job = cron.schedule(cronExpression, async () => {
      await this.triggersService.evaluateTriggers(
        'cron',
        {
          triggerId: trigger.id,
          scheduledAt: new Date().toISOString(),
        },
        trigger.workspaceId,
      );
    }, { timezone });

    this.scheduledJobs.set(trigger.id, job);
  }

  unscheduleTrigger(triggerId: string) {
    const job = this.scheduledJobs.get(triggerId);
    if (job) {
      job.stop();
      this.scheduledJobs.delete(triggerId);
    }
  }
}
```

### 2.4 API Endpoints

```typescript
@Controller('bpmn/triggers')
@UseGuards(JwtAuthGuard)
export class TriggersController {
  constructor(private triggersService: TriggersService) {}

  @Get('workspace/:workspaceId')
  async findByWorkspace(@Param('workspaceId') workspaceId: string) {
    return this.triggersService.findByWorkspace(workspaceId);
  }

  @Post()
  async create(
    @Body() dto: CreateTriggerDto,
    @CurrentUser() user: User,
  ) {
    return this.triggersService.create(dto, user.id);
  }

  @Put(':id')
  async update(
    @Param('id') id: string,
    @Body() dto: UpdateTriggerDto,
  ) {
    return this.triggersService.update(id, dto);
  }

  @Delete(':id')
  async delete(@Param('id') id: string) {
    return this.triggersService.delete(id);
  }

  @Post(':id/toggle')
  async toggle(@Param('id') id: string) {
    return this.triggersService.toggle(id);
  }

  @Get(':id/executions')
  async getExecutions(
    @Param('id') id: string,
    @Query('limit') limit = 50,
  ) {
    return this.triggersService.getExecutions(id, limit);
  }

  // Webhook endpoint
  @Post('webhook/:triggerId')
  async handleWebhook(
    @Param('triggerId') triggerId: string,
    @Body() body: any,
    @Headers('x-webhook-secret') secret: string,
  ) {
    return this.triggersService.handleWebhook(triggerId, body, secret);
  }
}
```

### 2.5 Frontend: UI ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

```
apps/frontend/src/components/bpmn/triggers/
â”œâ”€â”€ TriggersList.tsx           # Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ğ¾Ğ²
â”œâ”€â”€ TriggerForm.tsx            # Ğ¤Ğ¾Ñ€Ğ¼Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ/Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
â”œâ”€â”€ TriggerConditionsEditor.tsx # Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¾Ñ€ ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ğ¹
â”œâ”€â”€ TriggerExecutionLog.tsx    # Ğ›Ğ¾Ğ³ ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğ¹
â””â”€â”€ CronExpressionBuilder.tsx  # Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ĞµĞ»ÑŒ cron
```

---

## 3. Human Tasks (ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸)

### 3.1 ĞšĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ

Human Tasks â€” Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸, Ñ‚Ñ€ĞµĞ±ÑƒÑÑ‰Ğ¸Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ñ‡ĞµĞ»Ğ¾Ğ²ĞµĞºĞ°. Ğ’ Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ¸Ğµ Ğ¾Ñ‚ Service Tasks (Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ…), Ğ¾Ğ½Ğ¸:
- ĞŸĞ¾ÑĞ²Ğ»ÑÑÑ‚ÑÑ Ğ² "Inbox" Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
- Ğ˜Ğ¼ĞµÑÑ‚ Ñ„Ğ¾Ñ€Ğ¼Ñ‹ Ğ´Ğ»Ñ Ğ²Ğ²Ğ¾Ğ´Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ÑÑ‚ Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¸ Ğ´ĞµĞ»ĞµĞ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
- Ğ˜Ğ¼ĞµÑÑ‚ ÑÑ€Ğ¾ĞºĞ¸ Ğ¸ Ğ½Ğ°Ğ¿Ğ¾Ğ¼Ğ¸Ğ½Ğ°Ğ½Ğ¸Ñ

### 3.2 ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```sql
-- ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸
CREATE TABLE user_tasks (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

  -- Ğ¡Ğ²ÑĞ·ÑŒ Ñ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ¼
  process_instance_id UUID NOT NULL REFERENCES process_instances(id) ON DELETE CASCADE,
  workspace_id UUID NOT NULL REFERENCES workspaces(id),
  entity_id UUID REFERENCES entities(id),

  -- Zeebe Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
  job_key VARCHAR(255) NOT NULL UNIQUE,  -- Zeebe job key Ğ´Ğ»Ñ complete
  element_id VARCHAR(255) NOT NULL,       -- ID ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ° Ğ² BPMN
  element_name VARCHAR(255),              -- ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸Ğ· BPMN

  -- Ğ¢Ğ¸Ğ¿ Ğ¸ Ñ„Ğ¾Ñ€Ğ¼Ğ°
  task_type VARCHAR(100) NOT NULL,  -- 'approval', 'review', 'data-entry', 'custom'
  form_key VARCHAR(255),            -- Ğ¡ÑÑ‹Ğ»ĞºĞ° Ğ½Ğ° Ñ„Ğ¾Ñ€Ğ¼Ñƒ
  form_schema JSONB,                -- JSON Schema Ñ„Ğ¾Ñ€Ğ¼Ñ‹ (ĞµÑĞ»Ğ¸ inline)
  form_data JSONB DEFAULT '{}',     -- Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ

  -- ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ
  assignee_id UUID REFERENCES users(id),
  assignee_email VARCHAR(255),
  candidate_groups TEXT[],          -- ['managers', 'finance-team']
  candidate_users UUID[],           -- ĞšĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸-ĞºĞ°Ğ½Ğ´Ğ¸Ğ´Ğ°Ñ‚Ñ‹

  -- Ğ¡Ñ€Ğ¾ĞºĞ¸
  due_date TIMESTAMPTZ,
  follow_up_date TIMESTAMPTZ,
  priority INT DEFAULT 50,          -- 0-100, Ğ²Ñ‹ÑˆĞµ = Ğ²Ğ°Ğ¶Ğ½ĞµĞµ

  -- Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ
  status VARCHAR(50) NOT NULL DEFAULT 'created',
  -- 'created' -> 'claimed' -> 'completed'
  -- 'created' -> 'claimed' -> 'delegated' -> 'claimed' -> 'completed'
  -- 'created' -> 'expired'

  claimed_at TIMESTAMPTZ,
  claimed_by_id UUID REFERENCES users(id),
  completed_at TIMESTAMPTZ,
  completed_by_id UUID REFERENCES users(id),

  -- Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚
  completion_result JSONB,  -- Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ„Ğ¾Ñ€Ğ¼Ñ‹ Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ğ¸

  -- Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ (Ğ´Ğ»Ñ Ğ°ÑƒĞ´Ğ¸Ñ‚Ğ°)
  history JSONB DEFAULT '[]',

  -- ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ° (snapshot)
  process_variables JSONB DEFAULT '{}',

  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹ Ğ´Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ·Ğ°Ğ´Ğ°Ñ‡
CREATE INDEX idx_user_tasks_assignee ON user_tasks(assignee_id) WHERE status IN ('created', 'claimed');
CREATE INDEX idx_user_tasks_workspace ON user_tasks(workspace_id);
CREATE INDEX idx_user_tasks_status ON user_tasks(status);
CREATE INDEX idx_user_tasks_due_date ON user_tasks(due_date) WHERE status IN ('created', 'claimed');
CREATE INDEX idx_user_tasks_candidate_groups ON user_tasks USING GIN(candidate_groups);
CREATE INDEX idx_user_tasks_candidate_users ON user_tasks USING GIN(candidate_users);
CREATE INDEX idx_user_tasks_job_key ON user_tasks(job_key);

-- ĞšĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¸ Ğº Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ°Ğ¼
CREATE TABLE user_task_comments (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  task_id UUID NOT NULL REFERENCES user_tasks(id) ON DELETE CASCADE,
  user_id UUID NOT NULL REFERENCES users(id),
  content TEXT NOT NULL,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_user_task_comments_task ON user_task_comments(task_id);
```

### 3.3 Backend: UserTasksModule

```
apps/backend/src/modules/bpmn/user-tasks/
â”œâ”€â”€ user-tasks.module.ts
â”œâ”€â”€ user-tasks.service.ts
â”œâ”€â”€ user-tasks.controller.ts
â”œâ”€â”€ user-tasks.worker.ts         # Zeebe worker Ğ´Ğ»Ñ user tasks
â”œâ”€â”€ dto/
â”‚   â”œâ”€â”€ claim-task.dto.ts
â”‚   â”œâ”€â”€ complete-task.dto.ts
â”‚   â”œâ”€â”€ delegate-task.dto.ts
â”‚   â””â”€â”€ task-query.dto.ts
â””â”€â”€ interfaces/
    â””â”€â”€ user-task.interface.ts
```

#### user-tasks.worker.ts

```typescript
@Injectable()
export class UserTasksWorker implements OnModuleInit {
  constructor(
    private bpmnService: BpmnService,
    private userTasksService: UserTasksService,
  ) {}

  onModuleInit() {
    this.registerWorker();
  }

  private registerWorker() {
    const zeebeClient = this.bpmnService.getZeebeClient();
    if (!zeebeClient) return;

    // Worker Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ user tasks
    zeebeClient.createWorker({
      taskType: 'user-task',
      taskHandler: async (job) => {
        const {
          taskType,
          formKey,
          formSchema,
          assignee,
          candidateGroups,
          candidateUsers,
          dueDate,
          priority,
          ...variables
        } = job.variables as any;

        // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ Ğ² Ğ½Ğ°ÑˆĞµĞ¹ Ğ‘Ğ”
        await this.userTasksService.createFromJob({
          jobKey: String(job.key),
          processInstanceKey: String(job.processInstanceKey),
          elementId: job.elementId,
          elementName: job.customHeaders?.name || job.elementId,
          taskType: taskType || 'custom',
          formKey,
          formSchema,
          assignee,
          candidateGroups: candidateGroups?.split(',') || [],
          candidateUsers: candidateUsers?.split(',') || [],
          dueDate: dueDate ? new Date(dueDate) : null,
          priority: priority || 50,
          processVariables: variables,
        });

        // ĞĞ• Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ°ĞµĞ¼ job - Ğ¾Ğ½ Ğ±ÑƒĞ´ĞµÑ‚ Ğ·Ğ°Ğ²ĞµÑ€ÑˆÑ‘Ğ½ ĞºĞ¾Ğ³Ğ´Ğ° Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ
        // Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼ job Ğ±ĞµĞ· complete Ğ´Ğ»Ñ "Ğ·Ğ°Ğ¼Ğ¾Ñ€Ğ¾Ğ·ĞºĞ¸" Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ°
        return job.forward();
      },
      // Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ timeout Ğ´Ğ»Ñ user tasks
      timeout: Duration.days.of(30),
    });
  }
}
```

#### user-tasks.service.ts

```typescript
@Injectable()
export class UserTasksService {
  constructor(
    @InjectRepository(UserTask)
    private taskRepository: Repository<UserTask>,
    private bpmnService: BpmnService,
    private eventsGateway: EventsGateway,
    private emailService: EmailService,
  ) {}

  // ==================== Queries ====================

  /**
   * ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ (inbox)
   */
  async findForUser(
    userId: string,
    userGroups: string[],
    filters: TaskQueryDto,
  ): Promise<{ tasks: UserTask[]; total: number }> {
    const qb = this.taskRepository.createQueryBuilder('task')
      .leftJoinAndSelect('task.processInstance', 'instance')
      .leftJoinAndSelect('instance.processDefinition', 'definition')
      .where('task.status IN (:...statuses)', {
        statuses: ['created', 'claimed']
      });

    // Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ½Ñ‹Ğµ Ğ¼Ğ½Ğµ Ğ˜Ğ›Ğ˜ Ñ Ğ² ĞºĞ°Ğ½Ğ´Ğ¸Ğ´Ğ°Ñ‚Ğ°Ñ…
    qb.andWhere(
      new Brackets((sub) => {
        sub.where('task.assignee_id = :userId', { userId })
           .orWhere('task.candidate_users @> ARRAY[:userId]::uuid[]', { userId })
           .orWhere('task.candidate_groups && ARRAY[:...groups]::text[]', { groups: userGroups });
      }),
    );

    // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ñ‹
    if (filters.workspaceId) {
      qb.andWhere('task.workspace_id = :workspaceId', { workspaceId: filters.workspaceId });
    }
    if (filters.taskType) {
      qb.andWhere('task.task_type = :taskType', { taskType: filters.taskType });
    }
    if (filters.priority) {
      qb.andWhere('task.priority >= :priority', { priority: filters.priority });
    }
    if (filters.dueBefore) {
      qb.andWhere('task.due_date <= :dueBefore', { dueBefore: filters.dueBefore });
    }

    // Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°
    switch (filters.sortBy) {
      case 'dueDate':
        qb.orderBy('task.due_date', 'ASC', 'NULLS LAST');
        break;
      case 'priority':
        qb.orderBy('task.priority', 'DESC');
        break;
      case 'created':
      default:
        qb.orderBy('task.created_at', 'DESC');
    }

    const [tasks, total] = await qb
      .skip(filters.offset || 0)
      .take(filters.limit || 20)
      .getManyAndCount();

    return { tasks, total };
  }

  /**
   * ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ¿Ğ¾ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°Ğ¼
   */
  async getTaskCounts(userId: string, userGroups: string[]): Promise<{
    assigned: number;
    candidate: number;
    overdue: number;
  }> {
    const baseQuery = this.taskRepository.createQueryBuilder('task')
      .where('task.status IN (:...statuses)', { statuses: ['created', 'claimed'] });

    const [assigned, candidate, overdue] = await Promise.all([
      // ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ½Ñ‹Ğµ Ğ¼Ğ½Ğµ
      baseQuery.clone()
        .andWhere('task.assignee_id = :userId', { userId })
        .getCount(),

      // Ğ¯ Ğ² ĞºĞ°Ğ½Ğ´Ğ¸Ğ´Ğ°Ñ‚Ğ°Ñ… (Ğ½Ğ¾ Ğ½Ğµ Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¾)
      baseQuery.clone()
        .andWhere('task.assignee_id IS NULL')
        .andWhere(
          new Brackets((sub) => {
            sub.where('task.candidate_users @> ARRAY[:userId]::uuid[]', { userId })
               .orWhere('task.candidate_groups && ARRAY[:...groups]::text[]', { groups: userGroups });
          }),
        )
        .getCount(),

      // ĞŸÑ€Ğ¾ÑÑ€Ğ¾Ñ‡ĞµĞ½Ğ½Ñ‹Ğµ
      baseQuery.clone()
        .andWhere('task.assignee_id = :userId', { userId })
        .andWhere('task.due_date < NOW()')
        .getCount(),
    ]);

    return { assigned, candidate, overdue };
  }

  // ==================== Actions ====================

  /**
   * Ğ’Ğ·ÑÑ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ Ğ² Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñƒ
   */
  async claim(taskId: string, userId: string): Promise<UserTask> {
    const task = await this.findOneOrFail(taskId);

    if (task.status !== 'created') {
      throw new BadRequestException('Task is already claimed');
    }

    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ²Ğ·ÑÑ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ
    await this.validateCanClaim(task, userId);

    task.status = 'claimed';
    task.claimedAt = new Date();
    task.claimedById = userId;
    task.assigneeId = userId;

    this.addHistory(task, 'claimed', userId);

    const saved = await this.taskRepository.save(task);

    // Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ¸Ñ‚ÑŒ Ñ‡ĞµÑ€ĞµĞ· WebSocket
    this.eventsGateway.emitToUser(userId, 'task:claimed', { taskId });

    return saved;
  }

  /**
   * Ğ’ĞµÑ€Ğ½ÑƒÑ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ
   */
  async unclaim(taskId: string, userId: string): Promise<UserTask> {
    const task = await this.findOneOrFail(taskId);

    if (task.claimedById !== userId) {
      throw new ForbiddenException('You can only unclaim your own tasks');
    }

    task.status = 'created';
    task.claimedAt = null;
    task.claimedById = null;
    task.assigneeId = null;

    this.addHistory(task, 'unclaimed', userId);

    return this.taskRepository.save(task);
  }

  /**
   * Ğ”ĞµĞ»ĞµĞ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¼Ñƒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
   */
  async delegate(
    taskId: string,
    fromUserId: string,
    toUserId: string,
    comment?: string,
  ): Promise<UserTask> {
    const task = await this.findOneOrFail(taskId);

    if (task.assigneeId !== fromUserId) {
      throw new ForbiddenException('You can only delegate your own tasks');
    }

    task.assigneeId = toUserId;
    task.status = 'created'; // Ğ¡Ğ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°ĞµĞ¼ Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ assignee Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ claim

    this.addHistory(task, 'delegated', fromUserId, {
      toUserId,
      comment
    });

    const saved = await this.taskRepository.save(task);

    // Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ¸Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ assignee
    this.eventsGateway.emitToUser(toUserId, 'task:delegated', {
      taskId,
      fromUserId,
      comment,
    });

    return saved;
  }

  /**
   * Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ
   */
  async complete(
    taskId: string,
    userId: string,
    formData: Record<string, any>,
  ): Promise<UserTask> {
    const task = await this.findOneOrFail(taskId);

    if (task.assigneeId !== userId) {
      throw new ForbiddenException('You can only complete your own tasks');
    }

    // Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ñ„Ğ¾Ñ€Ğ¼Ñ‹
    if (task.formSchema) {
      this.validateFormData(task.formSchema, formData);
    }

    // Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ job Ğ² Zeebe
    await this.bpmnService.completeJob(task.jobKey, formData);

    // ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ
    task.status = 'completed';
    task.completedAt = new Date();
    task.completedById = userId;
    task.completionResult = formData;
    task.formData = formData;

    this.addHistory(task, 'completed', userId, { formData });

    return this.taskRepository.save(task);
  }

  // ==================== Helpers ====================

  private addHistory(
    task: UserTask,
    action: string,
    userId: string,
    data?: Record<string, any>,
  ) {
    const history = task.history || [];
    history.push({
      action,
      userId,
      timestamp: new Date().toISOString(),
      data,
    });
    task.history = history;
  }

  private validateFormData(schema: any, data: Record<string, any>) {
    // TODO: Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ ajv Ğ´Ğ»Ñ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸ JSON Schema
  }

  private async validateCanClaim(task: UserTask, userId: string) {
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ² ĞºĞ°Ğ½Ğ´Ğ¸Ğ´Ğ°Ñ‚Ğ°Ñ… Ğ¸Ğ»Ğ¸ ÑƒĞ¶Ğµ assignee
    // TODO: ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
  }
}
```

### 3.4 API Endpoints

```typescript
@Controller('bpmn/tasks')
@UseGuards(JwtAuthGuard)
export class UserTasksController {
  constructor(private userTasksService: UserTasksService) {}

  // Inbox
  @Get('inbox')
  async getInbox(
    @CurrentUser() user: User,
    @Query() query: TaskQueryDto,
  ) {
    const userGroups = await this.getUserGroups(user.id);
    return this.userTasksService.findForUser(user.id, userGroups, query);
  }

  // Ğ¡Ñ‡Ñ‘Ñ‚Ñ‡Ğ¸ĞºĞ¸
  @Get('counts')
  async getCounts(@CurrentUser() user: User) {
    const userGroups = await this.getUserGroups(user.id);
    return this.userTasksService.getTaskCounts(user.id, userGroups);
  }

  // Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸
  @Get(':id')
  async getTask(@Param('id') id: string) {
    return this.userTasksService.findOne(id);
  }

  // Ğ’Ğ·ÑÑ‚ÑŒ Ğ² Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñƒ
  @Post(':id/claim')
  async claim(
    @Param('id') id: string,
    @CurrentUser() user: User,
  ) {
    return this.userTasksService.claim(id, user.id);
  }

  // Ğ’ĞµÑ€Ğ½ÑƒÑ‚ÑŒ Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ
  @Post(':id/unclaim')
  async unclaim(
    @Param('id') id: string,
    @CurrentUser() user: User,
  ) {
    return this.userTasksService.unclaim(id, user.id);
  }

  // Ğ”ĞµĞ»ĞµĞ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ
  @Post(':id/delegate')
  async delegate(
    @Param('id') id: string,
    @Body() dto: DelegateTaskDto,
    @CurrentUser() user: User,
  ) {
    return this.userTasksService.delegate(id, user.id, dto.toUserId, dto.comment);
  }

  // Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ
  @Post(':id/complete')
  async complete(
    @Param('id') id: string,
    @Body() dto: CompleteTaskDto,
    @CurrentUser() user: User,
  ) {
    return this.userTasksService.complete(id, user.id, dto.formData);
  }

  // ĞšĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¸
  @Get(':id/comments')
  async getComments(@Param('id') id: string) {
    return this.userTasksService.getComments(id);
  }

  @Post(':id/comments')
  async addComment(
    @Param('id') id: string,
    @Body('content') content: string,
    @CurrentUser() user: User,
  ) {
    return this.userTasksService.addComment(id, user.id, content);
  }
}
```

### 3.5 Frontend: UI ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

```
apps/frontend/src/components/bpmn/tasks/
â”œâ”€â”€ TaskInbox.tsx              # Ğ“Ğ»Ğ°Ğ²Ğ½Ñ‹Ğ¹ inbox Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ğ¼Ğ¸
â”œâ”€â”€ TaskCard.tsx               # ĞšĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ° Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ² ÑĞ¿Ğ¸ÑĞºĞµ
â”œâ”€â”€ TaskDetail.tsx             # Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸
â”œâ”€â”€ TaskForm.tsx               # Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ñ„Ğ¾Ñ€Ğ¼Ğ° Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸
â”œâ”€â”€ TaskActions.tsx            # ĞšĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğ¹ (claim, complete, delegate)
â”œâ”€â”€ TaskComments.tsx           # ĞšĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¸ Ğº Ğ·Ğ°Ğ´Ğ°Ñ‡Ğµ
â”œâ”€â”€ TaskHistory.tsx            # Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹
â”œâ”€â”€ DelegateModal.tsx          # ĞœĞ¾Ğ´Ğ°Ğ» Ğ´ĞµĞ»ĞµĞ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
â””â”€â”€ hooks/
    â”œâ”€â”€ useTaskInbox.ts
    â””â”€â”€ useTaskActions.ts
```

---

## 4. Ğ¤Ğ¾Ñ€Ğ¼Ñ‹ Ğ¸ UI Ğ´Ğ»Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡

### 4.1 JSON Schema Ğ´Ğ»Ñ Ñ„Ğ¾Ñ€Ğ¼

```typescript
interface FormSchema {
  $id: string;
  type: 'object';
  title: string;
  description?: string;
  required?: string[];
  properties: Record<string, FormFieldSchema>;
  ui?: FormUISchema;
}

interface FormFieldSchema {
  type: 'string' | 'number' | 'boolean' | 'array' | 'object';
  title: string;
  description?: string;
  default?: any;

  // String specifics
  format?: 'date' | 'date-time' | 'email' | 'uri' | 'textarea' | 'richtext';
  minLength?: number;
  maxLength?: number;
  pattern?: string;

  // Number specifics
  minimum?: number;
  maximum?: number;

  // Enum (select/radio)
  enum?: any[];
  enumNames?: string[];

  // Array specifics
  items?: FormFieldSchema;
  minItems?: number;
  maxItems?: number;

  // Custom extensions
  'x-component'?: string;  // 'user-picker', 'file-upload', 'entity-select'
  'x-options'?: Record<string, any>;
}

interface FormUISchema {
  'ui:order'?: string[];
  [fieldName: string]: {
    'ui:widget'?: string;
    'ui:placeholder'?: string;
    'ui:help'?: string;
    'ui:disabled'?: boolean;
    'ui:hidden'?: boolean;
    'ui:options'?: Record<string, any>;
  };
}
```

### 4.2 ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ñ„Ğ¾Ñ€Ğ¼

#### Ğ¤Ğ¾Ñ€Ğ¼Ğ° ÑĞ¾Ğ³Ğ»Ğ°ÑĞ¾Ğ²Ğ°Ğ½Ğ¸Ñ

```json
{
  "$id": "approval-form",
  "type": "object",
  "title": "Ğ¡Ğ¾Ğ³Ğ»Ğ°ÑĞ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ÑĞ²ĞºĞ¸",
  "required": ["decision"],
  "properties": {
    "decision": {
      "type": "string",
      "title": "Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ",
      "enum": ["approved", "rejected", "needs_clarification"],
      "enumNames": ["Ğ¡Ğ¾Ğ³Ğ»Ğ°ÑĞ¾Ğ²Ğ°Ğ½Ğ¾", "ĞÑ‚ĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¾", "Ğ¢Ñ€ĞµĞ±ÑƒĞµÑ‚ ÑƒÑ‚Ğ¾Ñ‡Ğ½ĞµĞ½Ğ¸Ñ"]
    },
    "comment": {
      "type": "string",
      "title": "ĞšĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¹",
      "format": "textarea",
      "maxLength": 1000
    },
    "attachments": {
      "type": "array",
      "title": "Ğ’Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ",
      "items": {
        "type": "string",
        "format": "uri"
      },
      "x-component": "file-upload",
      "x-options": {
        "accept": ".pdf,.doc,.docx",
        "maxSize": 10485760
      }
    }
  },
  "ui": {
    "ui:order": ["decision", "comment", "attachments"],
    "comment": {
      "ui:widget": "textarea",
      "ui:options": { "rows": 4 }
    }
  }
}
```

#### Ğ¤Ğ¾Ñ€Ğ¼Ğ° Ğ²Ğ²Ğ¾Ğ´Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```json
{
  "$id": "purchase-request-form",
  "type": "object",
  "title": "Ğ—Ğ°ÑĞ²ĞºĞ° Ğ½Ğ° Ğ·Ğ°ĞºÑƒĞ¿ĞºÑƒ",
  "required": ["items", "justification", "budget"],
  "properties": {
    "items": {
      "type": "array",
      "title": "ĞŸĞ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["name", "quantity", "estimatedPrice"],
        "properties": {
          "name": { "type": "string", "title": "ĞĞ°Ğ¸Ğ¼ĞµĞ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ" },
          "quantity": { "type": "number", "title": "ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾", "minimum": 1 },
          "unit": { "type": "string", "title": "Ğ•Ğ´. Ğ¸Ğ·Ğ¼.", "default": "ÑˆÑ‚" },
          "estimatedPrice": { "type": "number", "title": "ĞÑ€Ğ¸ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ¾Ñ‡Ğ½Ğ°Ñ Ñ†ĞµĞ½Ğ°" },
          "supplier": { "type": "string", "title": "ĞŸÑ€ĞµĞ´Ğ¿Ğ¾Ñ‡Ñ‚Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ñ‰Ğ¸Ğº" }
        }
      }
    },
    "justification": {
      "type": "string",
      "title": "ĞĞ±Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºÑƒĞ¿ĞºĞ¸",
      "format": "textarea"
    },
    "budget": {
      "type": "string",
      "title": "Ğ¡Ñ‚Ğ°Ñ‚ÑŒÑ Ğ±ÑĞ´Ğ¶ĞµÑ‚Ğ°",
      "enum": ["opex", "capex", "project"],
      "enumNames": ["OPEX", "CAPEX", "ĞŸÑ€Ğ¾ĞµĞºÑ‚Ğ½Ñ‹Ğ¹ Ğ±ÑĞ´Ğ¶ĞµÑ‚"]
    },
    "urgency": {
      "type": "string",
      "title": "Ğ¡Ñ€Ğ¾Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ",
      "enum": ["normal", "urgent", "critical"],
      "enumNames": ["ĞĞ±Ñ‹Ñ‡Ğ½Ğ°Ñ", "Ğ¡Ñ€Ğ¾Ñ‡Ğ½Ğ°Ñ", "ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ"],
      "default": "normal"
    },
    "desiredDeliveryDate": {
      "type": "string",
      "title": "Ğ–ĞµĞ»Ğ°ĞµĞ¼Ğ°Ñ Ğ´Ğ°Ñ‚Ğ° Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ¸",
      "format": "date"
    }
  }
}
```

### 4.3 Ğ¥Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ñ„Ğ¾Ñ€Ğ¼

```sql
-- Ğ‘Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ° Ñ„Ğ¾Ñ€Ğ¼
CREATE TABLE form_definitions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  workspace_id UUID REFERENCES workspaces(id),  -- NULL = Ğ³Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ñ„Ğ¾Ñ€Ğ¼Ğ°

  key VARCHAR(255) NOT NULL,  -- ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ĞºĞ»ÑÑ‡ Ñ„Ğ¾Ñ€Ğ¼Ñ‹
  name VARCHAR(255) NOT NULL,
  description TEXT,

  schema JSONB NOT NULL,      -- JSON Schema
  ui_schema JSONB,            -- UI Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸

  version INT DEFAULT 1,
  is_active BOOLEAN DEFAULT true,

  created_by_id UUID REFERENCES users(id),
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),

  UNIQUE(workspace_id, key)
);

CREATE INDEX idx_form_definitions_workspace ON form_definitions(workspace_id);
CREATE INDEX idx_form_definitions_key ON form_definitions(key);
```

### 4.4 Frontend: DynamicForm ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚

```typescript
// apps/frontend/src/components/bpmn/forms/DynamicForm.tsx

interface DynamicFormProps {
  schema: FormSchema;
  uiSchema?: FormUISchema;
  initialData?: Record<string, any>;
  onSubmit: (data: Record<string, any>) => void;
  onCancel?: () => void;
  readOnly?: boolean;
}

export function DynamicForm({
  schema,
  uiSchema,
  initialData,
  onSubmit,
  onCancel,
  readOnly,
}: DynamicFormProps) {
  const [formData, setFormData] = useState(initialData || {});
  const [errors, setErrors] = useState<Record<string, string>>({});

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();

    // Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ
    const validationErrors = validateFormData(schema, formData);
    if (Object.keys(validationErrors).length > 0) {
      setErrors(validationErrors);
      return;
    }

    onSubmit(formData);
  };

  const renderField = (fieldName: string, fieldSchema: FormFieldSchema) => {
    const fieldUI = uiSchema?.[fieldName] || {};
    const value = formData[fieldName];
    const error = errors[fieldName];
    const isRequired = schema.required?.includes(fieldName);

    // ĞšĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
    if (fieldSchema['x-component']) {
      return renderCustomComponent(
        fieldSchema['x-component'],
        { fieldName, fieldSchema, value, onChange: handleFieldChange, ...fieldSchema['x-options'] }
      );
    }

    // Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğµ Ñ‚Ğ¸Ğ¿Ñ‹
    switch (fieldSchema.type) {
      case 'string':
        if (fieldSchema.enum) {
          return (
            <SelectField
              name={fieldName}
              label={fieldSchema.title}
              options={fieldSchema.enum.map((v, i) => ({
                value: v,
                label: fieldSchema.enumNames?.[i] || v,
              }))}
              value={value}
              onChange={(v) => handleFieldChange(fieldName, v)}
              error={error}
              required={isRequired}
              disabled={readOnly}
            />
          );
        }
        if (fieldSchema.format === 'textarea' || fieldSchema.format === 'richtext') {
          return (
            <TextareaField
              name={fieldName}
              label={fieldSchema.title}
              value={value || ''}
              onChange={(v) => handleFieldChange(fieldName, v)}
              error={error}
              required={isRequired}
              disabled={readOnly}
              rows={fieldUI['ui:options']?.rows || 3}
            />
          );
        }
        if (fieldSchema.format === 'date' || fieldSchema.format === 'date-time') {
          return (
            <DateField
              name={fieldName}
              label={fieldSchema.title}
              value={value}
              onChange={(v) => handleFieldChange(fieldName, v)}
              showTime={fieldSchema.format === 'date-time'}
              error={error}
              required={isRequired}
              disabled={readOnly}
            />
          );
        }
        return (
          <TextField
            name={fieldName}
            label={fieldSchema.title}
            value={value || ''}
            onChange={(v) => handleFieldChange(fieldName, v)}
            error={error}
            required={isRequired}
            disabled={readOnly}
            placeholder={fieldUI['ui:placeholder']}
          />
        );

      case 'number':
        return (
          <NumberField
            name={fieldName}
            label={fieldSchema.title}
            value={value}
            onChange={(v) => handleFieldChange(fieldName, v)}
            min={fieldSchema.minimum}
            max={fieldSchema.maximum}
            error={error}
            required={isRequired}
            disabled={readOnly}
          />
        );

      case 'boolean':
        return (
          <CheckboxField
            name={fieldName}
            label={fieldSchema.title}
            checked={!!value}
            onChange={(v) => handleFieldChange(fieldName, v)}
            disabled={readOnly}
          />
        );

      case 'array':
        return (
          <ArrayField
            name={fieldName}
            label={fieldSchema.title}
            itemSchema={fieldSchema.items!}
            value={value || []}
            onChange={(v) => handleFieldChange(fieldName, v)}
            minItems={fieldSchema.minItems}
            maxItems={fieldSchema.maxItems}
            error={error}
            disabled={readOnly}
          />
        );

      default:
        return null;
    }
  };

  const fieldOrder = uiSchema?.['ui:order'] || Object.keys(schema.properties);

  return (
    <form onSubmit={handleSubmit} className="space-y-4">
      {fieldOrder.map((fieldName) => {
        const fieldSchema = schema.properties[fieldName];
        if (!fieldSchema) return null;

        const fieldUI = uiSchema?.[fieldName];
        if (fieldUI?.['ui:hidden']) return null;

        return (
          <div key={fieldName}>
            {renderField(fieldName, fieldSchema)}
            {fieldUI?.['ui:help'] && (
              <p className="mt-1 text-sm text-gray-500">{fieldUI['ui:help']}</p>
            )}
          </div>
        );
      })}

      {!readOnly && (
        <div className="flex gap-2 pt-4">
          <button
            type="submit"
            className="px-4 py-2 bg-teal-600 text-white rounded-md hover:bg-teal-700"
          >
            ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ
          </button>
          {onCancel && (
            <button
              type="button"
              onClick={onCancel}
              className="px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300"
            >
              ĞÑ‚Ğ¼ĞµĞ½Ğ°
            </button>
          )}
        </div>
      )}
    </form>
  );
}
```

---

## 5. SLA Ğ¸ Ğ´ĞµĞ´Ğ»Ğ°Ğ¹Ğ½Ñ‹

### 5.1 ĞšĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ

SLA (Service Level Agreement) Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ñ€Ğ°Ğ¼ĞºĞ¸ Ğ´Ğ»Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ¸ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ². Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ°:
- ĞÑ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ñ‚ÑŒ ÑÑ€Ğ¾ĞºĞ¸
- ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑ‚ÑŒ Ğ½Ğ°Ğ¿Ğ¾Ğ¼Ğ¸Ğ½Ğ°Ğ½Ğ¸Ñ
- Ğ­ÑĞºĞ°Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¸ Ğ½Ğ°Ñ€ÑƒÑˆĞµĞ½Ğ¸Ğ¸
- Ğ¡Ğ¾Ğ±Ğ¸Ñ€Ğ°Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ

### 5.2 ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```sql
-- ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ SLA
CREATE TABLE sla_definitions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  workspace_id UUID NOT NULL REFERENCES workspaces(id) ON DELETE CASCADE,

  name VARCHAR(255) NOT NULL,
  description TEXT,

  -- Ğ£ÑĞ»Ğ¾Ğ²Ğ¸Ñ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ
  applies_to VARCHAR(50) NOT NULL,  -- 'entity', 'task', 'process'
  conditions JSONB DEFAULT '{}',     -- {"priority": "high", "category": "support"}

  -- Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ (Ğ² Ğ¼Ğ¸Ğ½ÑƒÑ‚Ğ°Ñ…)
  response_time INT,        -- Ğ’Ñ€ĞµĞ¼Ñ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°
  resolution_time INT,      -- Ğ’Ñ€ĞµĞ¼Ñ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ
  warning_threshold INT,    -- % Ğ¾Ñ‚ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ´Ğ»Ñ Ğ¿Ñ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ñ (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, 80)

  -- Ğ Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğµ Ñ‡Ğ°ÑÑ‹
  business_hours_only BOOLEAN DEFAULT true,
  business_hours JSONB DEFAULT '{"start": "09:00", "end": "18:00", "timezone": "Europe/Moscow", "workdays": [1,2,3,4,5]}',

  -- Ğ­ÑĞºĞ°Ğ»Ğ°Ñ†Ğ¸Ñ
  escalation_rules JSONB DEFAULT '[]',
  -- [
  --   {"threshold": 80, "action": "notify", "targets": ["assignee"]},
  --   {"threshold": 100, "action": "escalate", "targets": ["manager"]},
  --   {"threshold": 150, "action": "escalate", "targets": ["director"]}
  -- ]

  is_active BOOLEAN DEFAULT true,
  priority INT DEFAULT 0,  -- ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ° (Ğ²Ñ‹ÑˆĞµ = Ğ²Ğ°Ğ¶Ğ½ĞµĞµ)

  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_sla_definitions_workspace ON sla_definitions(workspace_id);

-- Ğ­ĞºĞ·ĞµĞ¼Ğ¿Ğ»ÑÑ€Ñ‹ SLA (Ğ¿Ñ€Ğ¸Ğ²ÑĞ·ĞºĞ° Ğº ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğ¼ ÑÑƒÑ‰Ğ½Ğ¾ÑÑ‚ÑĞ¼)
CREATE TABLE sla_instances (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  sla_definition_id UUID NOT NULL REFERENCES sla_definitions(id),
  workspace_id UUID NOT NULL REFERENCES workspaces(id),

  -- Ğ¡Ğ²ÑĞ·ÑŒ Ñ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ¾Ğ¼
  target_type VARCHAR(50) NOT NULL,  -- 'entity', 'task', 'process_instance'
  target_id UUID NOT NULL,

  -- Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ğ½Ğ½Ñ‹Ğµ ÑÑ€Ğ¾ĞºĞ¸
  response_due_at TIMESTAMPTZ,
  resolution_due_at TIMESTAMPTZ,

  -- Ğ¤Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ°
  first_response_at TIMESTAMPTZ,
  resolved_at TIMESTAMPTZ,

  -- Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ
  response_status VARCHAR(50),   -- 'pending', 'met', 'breached'
  resolution_status VARCHAR(50), -- 'pending', 'met', 'breached'

  -- ĞŸĞ°ÑƒĞ·Ğ° SLA (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ° ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°)
  is_paused BOOLEAN DEFAULT false,
  paused_at TIMESTAMPTZ,
  total_paused_minutes INT DEFAULT 0,

  -- Ğ­ÑĞºĞ°Ğ»Ğ°Ñ†Ğ¸Ñ
  current_escalation_level INT DEFAULT 0,
  last_escalation_at TIMESTAMPTZ,

  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_sla_instances_target ON sla_instances(target_type, target_id);
CREATE INDEX idx_sla_instances_due ON sla_instances(resolution_due_at)
  WHERE resolution_status = 'pending';

-- Ğ›Ğ¾Ğ³ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ SLA
CREATE TABLE sla_events (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  sla_instance_id UUID NOT NULL REFERENCES sla_instances(id) ON DELETE CASCADE,

  event_type VARCHAR(50) NOT NULL,
  -- 'created', 'response_recorded', 'resolved', 'breached',
  -- 'warning_sent', 'escalated', 'paused', 'resumed'

  event_data JSONB DEFAULT '{}',
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_sla_events_instance ON sla_events(sla_instance_id);
```

### 5.3 Backend: SlaModule

```
apps/backend/src/modules/sla/
â”œâ”€â”€ sla.module.ts
â”œâ”€â”€ sla.service.ts
â”œâ”€â”€ sla-calculator.service.ts   # Ğ Ğ°ÑÑ‡Ñ‘Ñ‚ ÑÑ€Ğ¾ĞºĞ¾Ğ² Ñ ÑƒÑ‡Ñ‘Ñ‚Ğ¾Ğ¼ Ñ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ñ… Ñ‡Ğ°ÑĞ¾Ğ²
â”œâ”€â”€ sla-monitor.service.ts      # ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ ÑÑĞºĞ°Ğ»Ğ°Ñ†Ğ¸Ñ
â”œâ”€â”€ sla.controller.ts
â”œâ”€â”€ entities/
â”‚   â”œâ”€â”€ sla-definition.entity.ts
â”‚   â””â”€â”€ sla-instance.entity.ts
â””â”€â”€ dto/
    â””â”€â”€ create-sla.dto.ts
```

#### sla-calculator.service.ts

```typescript
@Injectable()
export class SlaCalculatorService {
  /**
   * Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ğ´ĞµĞ´Ğ»Ğ°Ğ¹Ğ½ Ñ ÑƒÑ‡Ñ‘Ñ‚Ğ¾Ğ¼ Ñ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ñ… Ñ‡Ğ°ÑĞ¾Ğ²
   */
  calculateDeadline(
    startTime: Date,
    durationMinutes: number,
    businessHours: BusinessHours,
    businessHoursOnly: boolean,
  ): Date {
    if (!businessHoursOnly) {
      return addMinutes(startTime, durationMinutes);
    }

    let remainingMinutes = durationMinutes;
    let currentTime = new Date(startTime);

    while (remainingMinutes > 0) {
      // ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ, Ñ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ Ğ»Ğ¸ Ğ´ĞµĞ½ÑŒ
      const dayOfWeek = getDay(currentTime); // 0 = Sunday
      if (!businessHours.workdays.includes(dayOfWeek)) {
        // ĞŸĞµÑ€ĞµĞ¹Ñ‚Ğ¸ Ğº ÑĞ»ĞµĞ´ÑƒÑÑ‰ĞµĞ¼Ñƒ Ñ€Ğ°Ğ±Ğ¾Ñ‡ĞµĞ¼Ñƒ Ğ´Ğ½Ñ
        currentTime = this.getNextWorkdayStart(currentTime, businessHours);
        continue;
      }

      // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ñ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğµ Ñ‡Ğ°ÑÑ‹ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ Ğ´Ğ½Ñ
      const workStart = this.parseTime(businessHours.start, currentTime, businessHours.timezone);
      const workEnd = this.parseTime(businessHours.end, currentTime, businessHours.timezone);

      // Ğ•ÑĞ»Ğ¸ Ñ‚ĞµĞºÑƒÑ‰ĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ Ğ´Ğ¾ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‡ĞµĞ³Ğ¾ Ğ´Ğ½Ñ
      if (currentTime < workStart) {
        currentTime = workStart;
      }

      // Ğ•ÑĞ»Ğ¸ Ñ‚ĞµĞºÑƒÑ‰ĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ Ğ¿Ğ¾ÑĞ»Ğµ ĞºĞ¾Ğ½Ñ†Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‡ĞµĞ³Ğ¾ Ğ´Ğ½Ñ
      if (currentTime >= workEnd) {
        currentTime = this.getNextWorkdayStart(currentTime, businessHours);
        continue;
      }

      // Ğ¡ĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ¼Ğ¸Ğ½ÑƒÑ‚ Ğ¾ÑÑ‚Ğ°Ğ»Ğ¾ÑÑŒ Ğ´Ğ¾ ĞºĞ¾Ğ½Ñ†Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‡ĞµĞ³Ğ¾ Ğ´Ğ½Ñ
      const minutesToEndOfDay = differenceInMinutes(workEnd, currentTime);

      if (remainingMinutes <= minutesToEndOfDay) {
        // Ğ£ĞºĞ»Ğ°Ğ´Ñ‹Ğ²Ğ°ĞµĞ¼ÑÑ Ğ² Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ
        return addMinutes(currentTime, remainingMinutes);
      } else {
        // ĞĞµ ÑƒĞºĞ»Ğ°Ğ´Ñ‹Ğ²Ğ°ĞµĞ¼ÑÑ - Ğ²Ñ‹Ñ‡Ğ¸Ñ‚Ğ°ĞµĞ¼ Ğ¸ Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¸Ğ¼ Ğ½Ğ° ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ
        remainingMinutes -= minutesToEndOfDay;
        currentTime = this.getNextWorkdayStart(workEnd, businessHours);
      }
    }

    return currentTime;
  }

  /**
   * Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ğ¾ÑÑ‚Ğ°Ğ²ÑˆĞµĞµÑÑ Ğ²Ñ€ĞµĞ¼Ñ SLA Ğ² Ğ¼Ğ¸Ğ½ÑƒÑ‚Ğ°Ñ…
   */
  calculateRemainingMinutes(
    deadline: Date,
    currentTime: Date,
    businessHours: BusinessHours,
    businessHoursOnly: boolean,
    pausedMinutes: number = 0,
  ): number {
    if (!businessHoursOnly) {
      return differenceInMinutes(deadline, currentTime) + pausedMinutes;
    }

    // Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ñ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğµ Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹ Ğ¼ĞµĞ¶Ğ´Ñƒ currentTime Ğ¸ deadline
    let totalMinutes = 0;
    let iterTime = new Date(currentTime);

    while (iterTime < deadline) {
      const dayOfWeek = getDay(iterTime);
      if (!businessHours.workdays.includes(dayOfWeek)) {
        iterTime = this.getNextWorkdayStart(iterTime, businessHours);
        continue;
      }

      const workStart = this.parseTime(businessHours.start, iterTime, businessHours.timezone);
      const workEnd = this.parseTime(businessHours.end, iterTime, businessHours.timezone);

      const effectiveStart = iterTime < workStart ? workStart : iterTime;
      const effectiveEnd = deadline < workEnd ? deadline : workEnd;

      if (effectiveStart < effectiveEnd) {
        totalMinutes += differenceInMinutes(effectiveEnd, effectiveStart);
      }

      iterTime = this.getNextWorkdayStart(workEnd, businessHours);
    }

    return totalMinutes + pausedMinutes;
  }

  private getNextWorkdayStart(from: Date, bh: BusinessHours): Date {
    let next = addDays(startOfDay(from), 1);
    while (!bh.workdays.includes(getDay(next))) {
      next = addDays(next, 1);
    }
    return this.parseTime(bh.start, next, bh.timezone);
  }

  private parseTime(timeStr: string, date: Date, timezone: string): Date {
    const [hours, minutes] = timeStr.split(':').map(Number);
    return zonedTimeToUtc(
      set(date, { hours, minutes, seconds: 0, milliseconds: 0 }),
      timezone,
    );
  }
}
```

#### sla-monitor.service.ts

```typescript
@Injectable()
export class SlaMonitorService implements OnModuleInit {
  private readonly logger = new Logger(SlaMonitorService.name);

  constructor(
    @InjectRepository(SlaInstance)
    private slaInstanceRepository: Repository<SlaInstance>,
    private slaCalculator: SlaCalculatorService,
    private eventsGateway: EventsGateway,
    private emailService: EmailService,
  ) {}

  onModuleInit() {
    // Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºÑƒ ĞºĞ°Ğ¶Ğ´ÑƒÑ Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñƒ
    this.startMonitoring();
  }

  private startMonitoring() {
    setInterval(() => this.checkSlaViolations(), 60000);
  }

  async checkSlaViolations() {
    const now = new Date();

    // ĞĞ°Ğ¹Ñ‚Ğ¸ SLA, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ ÑĞºĞ¾Ñ€Ğ¾ Ğ¸ÑÑ‚ĞµĞºÑƒÑ‚ Ğ¸Ğ»Ğ¸ ÑƒĞ¶Ğµ Ğ¸ÑÑ‚ĞµĞºĞ»Ğ¸
    const pendingInstances = await this.slaInstanceRepository.find({
      where: [
        { responseStatus: 'pending' },
        { resolutionStatus: 'pending' },
      ],
      relations: ['slaDefinition'],
    });

    for (const instance of pendingInstances) {
      await this.checkInstance(instance, now);
    }
  }

  private async checkInstance(instance: SlaInstance, now: Date) {
    const definition = instance.slaDefinition;
    const warningThreshold = definition.warningThreshold || 80;

    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Response SLA
    if (instance.responseStatus === 'pending' && instance.responseDueAt) {
      const remainingMinutes = this.slaCalculator.calculateRemainingMinutes(
        instance.responseDueAt,
        now,
        definition.businessHours,
        definition.businessHoursOnly,
        instance.totalPausedMinutes,
      );

      const totalMinutes = definition.responseTime;
      const usedPercent = ((totalMinutes - remainingMinutes) / totalMinutes) * 100;

      if (remainingMinutes <= 0) {
        await this.handleBreach(instance, 'response');
      } else if (usedPercent >= warningThreshold) {
        await this.handleWarning(instance, 'response', usedPercent);
      }
    }

    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Resolution SLA
    if (instance.resolutionStatus === 'pending' && instance.resolutionDueAt) {
      const remainingMinutes = this.slaCalculator.calculateRemainingMinutes(
        instance.resolutionDueAt,
        now,
        definition.businessHours,
        definition.businessHoursOnly,
        instance.totalPausedMinutes,
      );

      const totalMinutes = definition.resolutionTime;
      const usedPercent = ((totalMinutes - remainingMinutes) / totalMinutes) * 100;

      if (remainingMinutes <= 0) {
        await this.handleBreach(instance, 'resolution');
      } else if (usedPercent >= warningThreshold) {
        await this.handleWarning(instance, 'resolution', usedPercent);
      }
    }
  }

  private async handleWarning(
    instance: SlaInstance,
    type: 'response' | 'resolution',
    usedPercent: number,
  ) {
    const rules = instance.slaDefinition.escalationRules || [];
    const applicableRule = rules.find(r =>
      r.threshold <= usedPercent &&
      r.threshold > (instance.currentEscalationLevel || 0)
    );

    if (!applicableRule) return;

    // ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ ÑÑĞºĞ°Ğ»Ğ°Ñ†Ğ¸Ğ¸
    await this.slaInstanceRepository.update(instance.id, {
      currentEscalationLevel: applicableRule.threshold,
      lastEscalationAt: new Date(),
    });

    // Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ
    if (applicableRule.action === 'notify') {
      await this.sendNotifications(instance, applicableRule.targets, 'warning', usedPercent);
    } else if (applicableRule.action === 'escalate') {
      await this.sendNotifications(instance, applicableRule.targets, 'escalation', usedPercent);
    }

    // Ğ—Ğ°Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ
    await this.logEvent(instance.id, 'warning_sent', {
      type,
      usedPercent,
      rule: applicableRule,
    });
  }

  private async handleBreach(
    instance: SlaInstance,
    type: 'response' | 'resolution',
  ) {
    const updateData = type === 'response'
      ? { responseStatus: 'breached' }
      : { resolutionStatus: 'breached' };

    await this.slaInstanceRepository.update(instance.id, updateData);

    // Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ¸Ñ‚ÑŒ Ğ¾ Ğ½Ğ°Ñ€ÑƒÑˆĞµĞ½Ğ¸Ğ¸
    const rules = instance.slaDefinition.escalationRules || [];
    const breachRule = rules.find(r => r.threshold >= 100);

    if (breachRule) {
      await this.sendNotifications(instance, breachRule.targets, 'breach', 100);
    }

    await this.logEvent(instance.id, 'breached', { type });
  }

  private async sendNotifications(
    instance: SlaInstance,
    targets: string[],
    notificationType: 'warning' | 'escalation' | 'breach',
    percent: number,
  ) {
    // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ email Ğ°Ğ´Ñ€ĞµÑĞ° Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ĞµĞ»ĞµĞ¹
    const recipients = await this.resolveTargets(instance, targets);

    for (const recipient of recipients) {
      // WebSocket ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ
      this.eventsGateway.emitToUser(recipient.userId, 'sla:alert', {
        instanceId: instance.id,
        type: notificationType,
        percent,
      });

      // Email
      await this.emailService.send({
        to: recipient.email,
        subject: this.getEmailSubject(instance, notificationType),
        html: this.getEmailBody(instance, notificationType, percent),
      });
    }
  }
}
```

### 5.4 API Endpoints

```typescript
@Controller('sla')
@UseGuards(JwtAuthGuard)
export class SlaController {
  // ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ SLA
  @Get('definitions')
  async getDefinitions(@Query('workspaceId') workspaceId: string) {}

  @Post('definitions')
  async createDefinition(@Body() dto: CreateSlaDefinitionDto) {}

  @Put('definitions/:id')
  async updateDefinition(@Param('id') id: string, @Body() dto: UpdateSlaDefinitionDto) {}

  @Delete('definitions/:id')
  async deleteDefinition(@Param('id') id: string) {}

  // Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ SLA Ğ´Ğ»Ñ ÑÑƒÑ‰Ğ½Ğ¾ÑÑ‚Ğ¸
  @Get('status/:targetType/:targetId')
  async getSlaStatus(
    @Param('targetType') targetType: string,
    @Param('targetId') targetId: string,
  ) {}

  // ĞŸĞ¾ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ SLA Ğ½Ğ° Ğ¿Ğ°ÑƒĞ·Ñƒ
  @Post('instances/:id/pause')
  async pauseSla(@Param('id') id: string, @Body('reason') reason: string) {}

  // Ğ¡Ğ½ÑÑ‚ÑŒ Ñ Ğ¿Ğ°ÑƒĞ·Ñ‹
  @Post('instances/:id/resume')
  async resumeSla(@Param('id') id: string) {}

  // Dashboard
  @Get('dashboard')
  async getDashboard(@Query('workspaceId') workspaceId: string) {}

  // ĞÑ‚Ñ‡Ñ‘Ñ‚ Ğ¿Ğ¾ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ SLA
  @Get('report')
  async getReport(
    @Query('workspaceId') workspaceId: string,
    @Query('from') from: string,
    @Query('to') to: string,
  ) {}
}
```

### 5.5 Frontend: UI ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

```
apps/frontend/src/components/sla/
â”œâ”€â”€ SlaIndicator.tsx        # Ğ˜Ğ½Ğ´Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€ SLA Ğ½Ğ° ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞµ Ğ·Ğ°ÑĞ²ĞºĞ¸
â”œâ”€â”€ SlaTimer.tsx            # ĞĞ±Ñ€Ğ°Ñ‚Ğ½Ñ‹Ğ¹ Ğ¾Ñ‚ÑÑ‡Ñ‘Ñ‚ Ğ´Ğ¾ Ğ´ĞµĞ´Ğ»Ğ°Ğ¹Ğ½Ğ°
â”œâ”€â”€ SlaDashboard.tsx        # Dashboard Ñ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ°Ğ¼Ğ¸
â”œâ”€â”€ SlaDefinitionForm.tsx   # Ğ¤Ğ¾Ñ€Ğ¼Ğ° Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ SLA
â”œâ”€â”€ SlaReport.tsx           # ĞÑ‚Ñ‡Ñ‘Ñ‚ Ğ¿Ğ¾ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ
â””â”€â”€ hooks/
    â””â”€â”€ useSlaStatus.ts
```

#### SlaIndicator.tsx

```tsx
interface SlaIndicatorProps {
  targetType: 'entity' | 'task';
  targetId: string;
}

export function SlaIndicator({ targetType, targetId }: SlaIndicatorProps) {
  const { data: sla, isLoading } = useSlaStatus(targetType, targetId);

  if (isLoading || !sla) return null;

  const getStatusColor = (status: string, remainingPercent: number) => {
    if (status === 'breached') return 'bg-red-500';
    if (status === 'met') return 'bg-green-500';
    if (remainingPercent < 20) return 'bg-red-400';
    if (remainingPercent < 50) return 'bg-yellow-400';
    return 'bg-green-400';
  };

  const remainingPercent = (sla.remainingMinutes / sla.totalMinutes) * 100;

  return (
    <div className="flex items-center gap-2">
      {/* Progress bar */}
      <div className="w-20 h-2 bg-gray-200 rounded-full overflow-hidden">
        <div
          className={`h-full ${getStatusColor(sla.status, remainingPercent)}`}
          style={{ width: `${Math.max(0, remainingPercent)}%` }}
        />
      </div>

      {/* Time remaining */}
      <span className={`text-xs ${remainingPercent < 20 ? 'text-red-600 font-medium' : 'text-gray-500'}`}>
        {sla.status === 'breached' ? (
          <span className="text-red-600">ĞŸÑ€Ğ¾ÑÑ€Ğ¾Ñ‡ĞµĞ½Ğ¾</span>
        ) : sla.status === 'met' ? (
          <span className="text-green-600">Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¾</span>
        ) : sla.isPaused ? (
          <span className="text-blue-600">ĞĞ° Ğ¿Ğ°ÑƒĞ·Ğµ</span>
        ) : (
          formatDuration(sla.remainingMinutes)
        )}
      </span>
    </div>
  );
}

function formatDuration(minutes: number): string {
  if (minutes < 60) return `${minutes}Ğ¼`;
  if (minutes < 1440) return `${Math.floor(minutes / 60)}Ñ‡ ${minutes % 60}Ğ¼`;
  return `${Math.floor(minutes / 1440)}Ğ´ ${Math.floor((minutes % 1440) / 60)}Ñ‡`;
}
```

---

## 6. Business Rules Engine (DMN)

### 6.1 ĞšĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ

DMN (Decision Model and Notation) â€” ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚ Ğ´Ğ»Ñ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ» Ğ² Ğ²Ğ¸Ğ´Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ† Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¹. ĞŸĞ¾Ğ·Ğ²Ğ¾Ğ»ÑĞµÑ‚:
- Ğ’Ñ‹Ğ½ĞµÑÑ‚Ğ¸ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºÑƒ Ğ¸Ğ· ĞºĞ¾Ğ´Ğ°
- Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ±ĞµĞ· Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¾Ğ²
- Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ¸Ğ·Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾
- Ğ’ĞµÑ€ÑĞ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°

### 6.2 ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```sql
-- Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¹
CREATE TABLE decision_tables (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  workspace_id UUID NOT NULL REFERENCES workspaces(id) ON DELETE CASCADE,

  key VARCHAR(255) NOT NULL,
  name VARCHAR(255) NOT NULL,
  description TEXT,

  -- DMN XML
  dmn_xml TEXT NOT NULL,

  -- Ğ”Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°: ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
  inputs JSONB NOT NULL,   -- [{"id": "priority", "label": "ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚", "type": "string"}]
  outputs JSONB NOT NULL,  -- [{"id": "route", "label": "ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚", "type": "string"}]
  rules JSONB NOT NULL,    -- ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ² JSON Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ

  -- Hit policy: UNIQUE, FIRST, PRIORITY, ANY, COLLECT, RULE ORDER
  hit_policy VARCHAR(50) DEFAULT 'FIRST',

  version INT DEFAULT 1,
  is_active BOOLEAN DEFAULT true,

  deployed_key VARCHAR(255),  -- ĞšĞ»ÑÑ‡ Ğ² Camunda ĞµÑĞ»Ğ¸ Ğ·Ğ°Ğ´ĞµĞ¿Ğ»Ğ¾ĞµĞ½Ğ¾
  deployed_at TIMESTAMPTZ,

  created_by_id UUID REFERENCES users(id),
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),

  UNIQUE(workspace_id, key)
);

CREATE INDEX idx_decision_tables_workspace ON decision_tables(workspace_id);
CREATE INDEX idx_decision_tables_key ON decision_tables(key);

-- Ğ›Ğ¾Ğ³ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ» (Ğ´Ğ»Ñ Ğ°ÑƒĞ´Ğ¸Ñ‚Ğ° Ğ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸)
CREATE TABLE decision_evaluations (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  decision_table_id UUID NOT NULL REFERENCES decision_tables(id),

  -- ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚
  process_instance_id UUID REFERENCES process_instances(id),
  entity_id UUID REFERENCES entities(id),

  -- Ğ’Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
  input_values JSONB NOT NULL,

  -- Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚
  output_values JSONB NOT NULL,
  matched_rules INT[],  -- Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹ ÑÑ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ²ÑˆĞ¸Ñ… Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»

  evaluated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_decision_evaluations_table ON decision_evaluations(decision_table_id);
CREATE INDEX idx_decision_evaluations_date ON decision_evaluations(evaluated_at);
```

### 6.3 Backend: DmnModule

```
apps/backend/src/modules/dmn/
â”œâ”€â”€ dmn.module.ts
â”œâ”€â”€ dmn.service.ts
â”œâ”€â”€ dmn-evaluator.service.ts    # Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ evaluator (Ğ±ĞµĞ· Camunda)
â”œâ”€â”€ dmn.controller.ts
â”œâ”€â”€ entities/
â”‚   â””â”€â”€ decision-table.entity.ts
â””â”€â”€ dto/
    â”œâ”€â”€ create-decision.dto.ts
    â””â”€â”€ evaluate-decision.dto.ts
```

#### dmn-evaluator.service.ts

```typescript
@Injectable()
export class DmnEvaluatorService {
  /**
   * ĞÑ†ĞµĞ½Ğ¸Ñ‚ÑŒ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¹ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾ (Ğ±ĞµĞ· Camunda)
   */
  evaluate(
    table: DecisionTable,
    inputs: Record<string, any>,
  ): { outputs: Record<string, any>[]; matchedRules: number[] } {
    const matchedRules: number[] = [];
    const outputs: Record<string, any>[] = [];

    for (let i = 0; i < table.rules.length; i++) {
      const rule = table.rules[i];

      if (this.matchesRule(rule.inputs, inputs, table.inputs)) {
        matchedRules.push(i);
        outputs.push(this.extractOutputs(rule.outputs, table.outputs));

        // ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ hit policy
        if (table.hitPolicy === 'FIRST' || table.hitPolicy === 'UNIQUE') {
          break;
        }
      }
    }

    // Ğ”Ğ»Ñ COLLECT - Ğ¾Ğ±ÑŠĞµĞ´Ğ¸Ğ½Ğ¸Ñ‚ÑŒ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹
    if (table.hitPolicy === 'COLLECT' && outputs.length > 1) {
      return {
        outputs: [this.collectOutputs(outputs, table.outputs)],
        matchedRules,
      };
    }

    return { outputs, matchedRules };
  }

  private matchesRule(
    ruleInputs: Record<string, any>,
    actualInputs: Record<string, any>,
    inputDefinitions: InputDefinition[],
  ): boolean {
    for (const inputDef of inputDefinitions) {
      const ruleValue = ruleInputs[inputDef.id];
      const actualValue = actualInputs[inputDef.id];

      // ĞŸÑƒÑÑ‚Ğ¾Ğµ ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ğµ = Ğ»ÑĞ±Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ
      if (ruleValue === null || ruleValue === undefined || ruleValue === '') {
        continue;
      }

      if (!this.matchesCondition(ruleValue, actualValue, inputDef.type)) {
        return false;
      }
    }
    return true;
  }

  private matchesCondition(
    condition: any,
    value: any,
    type: string,
  ): boolean {
    // Ğ¡Ñ‚Ñ€Ğ¾ĞºĞ¾Ğ²Ğ¾Ğµ ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ğµ - Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ²Ñ‹Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸ĞµĞ¼
    if (typeof condition === 'string') {
      // Ğ¢Ğ¾Ñ‡Ğ½Ğ¾Ğµ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğµ
      if (!condition.startsWith('[') && !condition.startsWith('<') && !condition.startsWith('>')) {
        return String(value) === condition;
      }

      // Ğ”Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½ [1..10]
      const rangeMatch = condition.match(/^\[(\d+)\.\.(\d+)\]$/);
      if (rangeMatch) {
        const [, min, max] = rangeMatch;
        return Number(value) >= Number(min) && Number(value) <= Number(max);
      }

      // Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ < > <= >=
      const compareMatch = condition.match(/^([<>]=?)\s*(.+)$/);
      if (compareMatch) {
        const [, op, compareValue] = compareMatch;
        const numValue = Number(value);
        const numCompare = Number(compareValue);
        switch (op) {
          case '<': return numValue < numCompare;
          case '>': return numValue > numCompare;
          case '<=': return numValue <= numCompare;
          case '>=': return numValue >= numCompare;
        }
      }

      // Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ Ñ‡ĞµÑ€ĞµĞ· Ğ·Ğ°Ğ¿ÑÑ‚ÑƒÑ
      if (condition.includes(',')) {
        const allowedValues = condition.split(',').map(v => v.trim());
        return allowedValues.includes(String(value));
      }
    }

    return condition === value;
  }

  private extractOutputs(
    ruleOutputs: Record<string, any>,
    outputDefinitions: OutputDefinition[],
  ): Record<string, any> {
    const result: Record<string, any> = {};
    for (const outputDef of outputDefinitions) {
      result[outputDef.id] = ruleOutputs[outputDef.id];
    }
    return result;
  }

  private collectOutputs(
    outputs: Record<string, any>[],
    outputDefinitions: OutputDefinition[],
  ): Record<string, any> {
    const result: Record<string, any> = {};
    for (const outputDef of outputDefinitions) {
      result[outputDef.id] = outputs.map(o => o[outputDef.id]);
    }
    return result;
  }
}
```

### 6.4 ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¹

```json
{
  "key": "ticket-routing",
  "name": "ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ·Ğ°ÑĞ²Ğ¾Ğº",
  "hitPolicy": "FIRST",
  "inputs": [
    { "id": "priority", "label": "ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚", "type": "string" },
    { "id": "category", "label": "ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ", "type": "string" },
    { "id": "amount", "label": "Ğ¡ÑƒĞ¼Ğ¼Ğ°", "type": "number" }
  ],
  "outputs": [
    { "id": "assigneeGroup", "label": "Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ĞµĞ¹", "type": "string" },
    { "id": "slaMinutes", "label": "SLA (Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹)", "type": "number" },
    { "id": "requiresApproval", "label": "Ğ¢Ñ€ĞµĞ±ÑƒĞµÑ‚ ÑĞ¾Ğ³Ğ»Ğ°ÑĞ¾Ğ²Ğ°Ğ½Ğ¸Ñ", "type": "boolean" }
  ],
  "rules": [
    {
      "inputs": { "priority": "critical", "category": "", "amount": "" },
      "outputs": { "assigneeGroup": "tier3", "slaMinutes": 60, "requiresApproval": false }
    },
    {
      "inputs": { "priority": "high", "category": "", "amount": ">100000" },
      "outputs": { "assigneeGroup": "tier2", "slaMinutes": 240, "requiresApproval": true }
    },
    {
      "inputs": { "priority": "high", "category": "", "amount": "" },
      "outputs": { "assigneeGroup": "tier2", "slaMinutes": 240, "requiresApproval": false }
    },
    {
      "inputs": { "priority": "medium,low", "category": "hardware", "amount": "" },
      "outputs": { "assigneeGroup": "hardware-team", "slaMinutes": 480, "requiresApproval": false }
    },
    {
      "inputs": { "priority": "", "category": "", "amount": "" },
      "outputs": { "assigneeGroup": "tier1", "slaMinutes": 1440, "requiresApproval": false }
    }
  ]
}
```

### 6.5 Frontend: DMN Editor

```
apps/frontend/src/components/dmn/
â”œâ”€â”€ DmnEditor.tsx           # Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¾Ñ€ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¹
â”œâ”€â”€ DecisionTableGrid.tsx   # Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¾Ñ€ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»
â”œâ”€â”€ DmnTester.tsx           # Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»
â”œâ”€â”€ DmnDeployButton.tsx     # ĞšĞ½Ğ¾Ğ¿ĞºĞ° Ğ´ĞµĞ¿Ğ»Ğ¾Ñ
â””â”€â”€ hooks/
    â””â”€â”€ useDmnEvaluate.ts
```

---

## 7. Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ñ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğ¼Ğ¸ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°Ğ¼Ğ¸

### 7.1 ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ĞºĞ¾Ğ½Ğ½ĞµĞºÑ‚Ğ¾Ñ€Ğ¾Ğ²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Connector Framework                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   Email     â”‚  â”‚  Telegram   â”‚  â”‚    REST     â”‚              â”‚
â”‚  â”‚  Connector  â”‚  â”‚  Connector  â”‚  â”‚  Connector  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚         â”‚                â”‚                â”‚                      â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                          â–¼                                       â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚              â”‚  Connector Registry â”‚                             â”‚
â”‚              â”‚  (discovers & loads â”‚                             â”‚
â”‚              â”‚   connectors)       â”‚                             â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                         â”‚                                        â”‚
â”‚                         â–¼                                        â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚              â”‚   Zeebe Workers     â”‚                             â”‚
â”‚              â”‚   (one per type)    â”‚                             â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```sql
-- ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸ ĞºĞ¾Ğ½Ğ½ĞµĞºÑ‚Ğ¾Ñ€Ğ¾Ğ² (credentials, endpoints)
CREATE TABLE connector_configs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  workspace_id UUID NOT NULL REFERENCES workspaces(id) ON DELETE CASCADE,

  connector_type VARCHAR(100) NOT NULL,  -- 'email', 'telegram', 'rest', '1c'
  name VARCHAR(255) NOT NULL,
  description TEXT,

  -- ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ (Ğ·Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹)
  config JSONB NOT NULL,
  -- email: { host, port, user, password, from }
  -- telegram: { botToken, defaultChatId }
  -- rest: { baseUrl, headers, auth }
  -- 1c: { baseUrl, user, password }

  is_active BOOLEAN DEFAULT true,
  is_default BOOLEAN DEFAULT false,

  -- Ğ”Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
  last_health_check TIMESTAMPTZ,
  health_status VARCHAR(50),

  created_by_id UUID REFERENCES users(id),
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_connector_configs_workspace ON connector_configs(workspace_id);
CREATE INDEX idx_connector_configs_type ON connector_configs(connector_type);

-- Ğ›Ğ¾Ğ³ Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ¾Ğ² ĞºĞ¾Ğ½Ğ½ĞµĞºÑ‚Ğ¾Ñ€Ğ¾Ğ²
CREATE TABLE connector_executions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  connector_config_id UUID NOT NULL REFERENCES connector_configs(id),
  process_instance_id UUID REFERENCES process_instances(id),

  action VARCHAR(100) NOT NULL,   -- 'send-email', 'send-message', 'http-request'
  request_data JSONB,
  response_data JSONB,

  status VARCHAR(50) NOT NULL,    -- 'success', 'failed', 'timeout'
  error_message TEXT,
  duration_ms INT,

  executed_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_connector_executions_config ON connector_executions(connector_config_id);
CREATE INDEX idx_connector_executions_date ON connector_executions(executed_at);
```

### 7.3 Backend: ConnectorsModule

```
apps/backend/src/modules/connectors/
â”œâ”€â”€ connectors.module.ts
â”œâ”€â”€ connectors.service.ts           # Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³Ğ°Ğ¼Ğ¸
â”œâ”€â”€ connector-registry.service.ts   # Ğ ĞµĞµÑÑ‚Ñ€ Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° ĞºĞ¾Ğ½Ğ½ĞµĞºÑ‚Ğ¾Ñ€Ğ¾Ğ²
â”œâ”€â”€ connectors.controller.ts
â”œâ”€â”€ types/
â”‚   â”œâ”€â”€ email/
â”‚   â”‚   â”œâ”€â”€ email.connector.ts
â”‚   â”‚   â”œâ”€â”€ email.schema.ts         # JSON Schema ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸
â”‚   â”‚   â””â”€â”€ email.worker.ts
â”‚   â”œâ”€â”€ telegram/
â”‚   â”‚   â”œâ”€â”€ telegram.connector.ts
â”‚   â”‚   â”œâ”€â”€ telegram.schema.ts
â”‚   â”‚   â””â”€â”€ telegram.worker.ts
â”‚   â”œâ”€â”€ rest/
â”‚   â”‚   â”œâ”€â”€ rest.connector.ts
â”‚   â”‚   â”œâ”€â”€ rest.schema.ts
â”‚   â”‚   â””â”€â”€ rest.worker.ts
â”‚   â””â”€â”€ 1c/
â”‚       â”œâ”€â”€ 1c.connector.ts
â”‚       â”œâ”€â”€ 1c.schema.ts
â”‚       â””â”€â”€ 1c.worker.ts
â””â”€â”€ dto/
    â””â”€â”€ create-connector.dto.ts
```

#### Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ ĞºĞ¾Ğ½Ğ½ĞµĞºÑ‚Ğ¾Ñ€Ğ°

```typescript
// connector.interface.ts
export interface Connector {
  type: string;
  name: string;
  description: string;

  // JSON Schema Ğ´Ğ»Ñ Ñ„Ğ¾Ñ€Ğ¼Ñ‹ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸
  configSchema: object;

  // Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ
  actions: ConnectorAction[];

  // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
  testConnection(config: Record<string, any>): Promise<{ success: boolean; message?: string }>;

  // Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ
  execute(
    action: string,
    config: Record<string, any>,
    params: Record<string, any>,
  ): Promise<ConnectorResult>;
}

export interface ConnectorAction {
  id: string;
  name: string;
  description: string;
  inputSchema: object;   // JSON Schema Ğ²Ñ…Ğ¾Ğ´Ğ½Ñ‹Ñ… Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²
  outputSchema: object;  // JSON Schema Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°
}

export interface ConnectorResult {
  success: boolean;
  data?: Record<string, any>;
  error?: string;
}
```

#### Telegram Connector

```typescript
// telegram.connector.ts
@Injectable()
export class TelegramConnector implements Connector {
  type = 'telegram';
  name = 'Telegram';
  description = 'ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹ Ñ‡ĞµÑ€ĞµĞ· Telegram Bot API';

  configSchema = {
    type: 'object',
    required: ['botToken'],
    properties: {
      botToken: {
        type: 'string',
        title: 'Bot Token',
        description: 'Ğ¢Ğ¾ĞºĞµĞ½ Ğ¾Ñ‚ @BotFather',
      },
      defaultChatId: {
        type: 'string',
        title: 'Chat ID Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ',
      },
    },
  };

  actions: ConnectorAction[] = [
    {
      id: 'send-message',
      name: 'ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ',
      description: 'ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ² Ñ‡Ğ°Ñ‚',
      inputSchema: {
        type: 'object',
        required: ['text'],
        properties: {
          chatId: { type: 'string', title: 'Chat ID' },
          text: { type: 'string', title: 'Ğ¢ĞµĞºÑÑ‚ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ' },
          parseMode: {
            type: 'string',
            enum: ['HTML', 'Markdown', 'MarkdownV2'],
            title: 'Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚',
          },
        },
      },
      outputSchema: {
        type: 'object',
        properties: {
          messageId: { type: 'number' },
          chatId: { type: 'number' },
        },
      },
    },
    {
      id: 'send-document',
      name: 'ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ„Ğ°Ğ¹Ğ»',
      description: 'ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ Ğ² Ñ‡Ğ°Ñ‚',
      inputSchema: {
        type: 'object',
        required: ['fileUrl'],
        properties: {
          chatId: { type: 'string' },
          fileUrl: { type: 'string', format: 'uri' },
          caption: { type: 'string' },
        },
      },
      outputSchema: {
        type: 'object',
        properties: {
          messageId: { type: 'number' },
        },
      },
    },
  ];

  async testConnection(config: Record<string, any>): Promise<{ success: boolean; message?: string }> {
    try {
      const response = await fetch(`https://api.telegram.org/bot${config.botToken}/getMe`);
      const data = await response.json();

      if (data.ok) {
        return { success: true, message: `ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¾ ĞºĞ°Ğº @${data.result.username}` };
      } else {
        return { success: false, message: data.description };
      }
    } catch (error) {
      return { success: false, message: error.message };
    }
  }

  async execute(
    action: string,
    config: Record<string, any>,
    params: Record<string, any>,
  ): Promise<ConnectorResult> {
    const chatId = params.chatId || config.defaultChatId;

    switch (action) {
      case 'send-message':
        return this.sendMessage(config.botToken, chatId, params.text, params.parseMode);

      case 'send-document':
        return this.sendDocument(config.botToken, chatId, params.fileUrl, params.caption);

      default:
        return { success: false, error: `Unknown action: ${action}` };
    }
  }

  private async sendMessage(
    botToken: string,
    chatId: string,
    text: string,
    parseMode?: string,
  ): Promise<ConnectorResult> {
    try {
      const response = await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          chat_id: chatId,
          text,
          parse_mode: parseMode,
        }),
      });

      const data = await response.json();

      if (data.ok) {
        return {
          success: true,
          data: {
            messageId: data.result.message_id,
            chatId: data.result.chat.id,
          },
        };
      } else {
        return { success: false, error: data.description };
      }
    } catch (error) {
      return { success: false, error: error.message };
    }
  }

  private async sendDocument(
    botToken: string,
    chatId: string,
    fileUrl: string,
    caption?: string,
  ): Promise<ConnectorResult> {
    // Implementation
  }
}
```

### 7.4 Zeebe Workers Ğ´Ğ»Ñ ĞºĞ¾Ğ½Ğ½ĞµĞºÑ‚Ğ¾Ñ€Ğ¾Ğ²

```typescript
// connector-workers.service.ts
@Injectable()
export class ConnectorWorkersService implements OnModuleInit {
  constructor(
    private bpmnService: BpmnService,
    private connectorRegistry: ConnectorRegistryService,
    private connectorsService: ConnectorsService,
  ) {}

  onModuleInit() {
    this.registerWorkers();
  }

  private registerWorkers() {
    const zeebeClient = this.bpmnService.getZeebeClient();
    if (!zeebeClient) return;

    // Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€ÑƒĞµĞ¼ worker Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ñ‚Ğ¸Ğ¿Ğ° ĞºĞ¾Ğ½Ğ½ĞµĞºÑ‚Ğ¾Ñ€Ğ°
    const connectorTypes = this.connectorRegistry.getTypes();

    for (const type of connectorTypes) {
      const connector = this.connectorRegistry.get(type);

      for (const action of connector.actions) {
        const taskType = `${type}:${action.id}`;

        zeebeClient.createWorker({
          taskType,
          taskHandler: async (job) => {
            const { connectorConfigId, ...params } = job.variables as any;

            try {
              // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ
              const config = await this.connectorsService.getConfig(connectorConfigId);

              if (!config || !config.isActive) {
                return job.fail({
                  errorMessage: 'Connector config not found or inactive',
                  retries: 0,
                });
              }

              // Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ
              const result = await connector.execute(action.id, config.config, params);

              if (result.success) {
                // Ğ›Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµĞ¼ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ
                await this.connectorsService.logExecution(config.id, job.processInstanceKey, {
                  action: action.id,
                  request: params,
                  response: result.data,
                  status: 'success',
                });

                return job.complete(result.data || {});
              } else {
                await this.connectorsService.logExecution(config.id, job.processInstanceKey, {
                  action: action.id,
                  request: params,
                  error: result.error,
                  status: 'failed',
                });

                return job.fail({
                  errorMessage: result.error,
                  retries: job.retries - 1,
                });
              }
            } catch (error) {
              return job.fail({
                errorMessage: error.message,
                retries: job.retries - 1,
              });
            }
          },
        });
      }
    }
  }
}
```

### 7.5 API Endpoints

```typescript
@Controller('connectors')
@UseGuards(JwtAuthGuard)
export class ConnectorsController {
  // Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğµ Ñ‚Ğ¸Ğ¿Ñ‹ ĞºĞ¾Ğ½Ğ½ĞµĞºÑ‚Ğ¾Ñ€Ğ¾Ğ²
  @Get('types')
  async getTypes() {
    return this.connectorRegistry.getTypesWithSchemas();
  }

  // ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸ workspace
  @Get('configs')
  async getConfigs(@Query('workspaceId') workspaceId: string) {}

  @Post('configs')
  async createConfig(@Body() dto: CreateConnectorConfigDto) {}

  @Put('configs/:id')
  async updateConfig(@Param('id') id: string, @Body() dto: UpdateConnectorConfigDto) {}

  @Delete('configs/:id')
  async deleteConfig(@Param('id') id: string) {}

  // Ğ¢ĞµÑÑ‚ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
  @Post('configs/:id/test')
  async testConnection(@Param('id') id: string) {}

  // Ğ›Ğ¾Ğ³ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğ¹
  @Get('configs/:id/executions')
  async getExecutions(
    @Param('id') id: string,
    @Query('limit') limit = 50,
  ) {}
}
```

---

## 8. Ğ’ĞµÑ€ÑĞ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²

### 8.1 ĞšĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ

ĞŸÑ€Ğ¸ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğ¸ BPMN-Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ° Ğ½ÑƒĞ¶Ğ½Ğ¾ Ñ€ĞµÑˆĞ¸Ñ‚ÑŒ, Ñ‡Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°Ñ‚ÑŒ Ñ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¼Ğ¸ ÑĞºĞ·ĞµĞ¼Ğ¿Ğ»ÑÑ€Ğ°Ğ¼Ğ¸:
- **ĞÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ½Ğ° ÑÑ‚Ğ°Ñ€Ğ¾Ğ¹ Ğ²ĞµÑ€ÑĞ¸Ğ¸** â€” Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ°Ñ‚ÑÑ Ğ¿Ğ¾ ÑÑ‚Ğ°Ñ€Ğ¾Ğ¹ Ğ»Ğ¾Ğ³Ğ¸ĞºĞµ
- **ĞœĞ¸Ğ³Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ** â€” Ğ¿ĞµÑ€ĞµĞ½ĞµÑÑ‚Ğ¸ Ğ½Ğ° Ğ½Ğ¾Ğ²ÑƒÑ Ğ²ĞµÑ€ÑĞ¸Ñ
- **ĞÑ‚Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ** â€” Ğ¿Ñ€ĞµÑ€Ğ²Ğ°Ñ‚ÑŒ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ

### 8.2 ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```sql
-- Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ²ĞµÑ€ÑĞ¸Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²
CREATE TABLE process_definition_versions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  process_definition_id UUID NOT NULL REFERENCES process_definitions(id) ON DELETE CASCADE,

  version INT NOT NULL,
  bpmn_xml TEXT NOT NULL,
  deployed_key VARCHAR(255),

  -- Diff Ğ¾Ñ‚ Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ĞµĞ¹ Ğ²ĞµÑ€ÑĞ¸Ğ¸
  changes_summary JSONB,
  -- { "added": ["task1"], "removed": ["task2"], "modified": ["gateway1"] }

  deployed_at TIMESTAMPTZ,
  deployed_by_id UUID REFERENCES users(id),

  UNIQUE(process_definition_id, version)
);

CREATE INDEX idx_process_versions_definition ON process_definition_versions(process_definition_id);

-- ĞŸĞ»Ğ°Ğ½Ñ‹ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸
CREATE TABLE migration_plans (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

  source_definition_key VARCHAR(255) NOT NULL,
  source_version INT NOT NULL,
  target_definition_key VARCHAR(255) NOT NULL,
  target_version INT NOT NULL,

  -- ĞœĞ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
  element_mappings JSONB NOT NULL,
  -- [{ "source": "oldTaskId", "target": "newTaskId" }]

  -- ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ñ…
  variable_updates JSONB,
  -- { "set": { "newVar": "value" }, "rename": { "oldVar": "newVar" }, "delete": ["obsoleteVar"] }

  -- Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ
  status VARCHAR(50) DEFAULT 'draft',  -- 'draft', 'ready', 'in_progress', 'completed', 'failed'

  -- Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ
  total_instances INT DEFAULT 0,
  migrated_instances INT DEFAULT 0,
  failed_instances INT DEFAULT 0,

  created_by_id UUID REFERENCES users(id),
  created_at TIMESTAMPTZ DEFAULT NOW(),
  executed_at TIMESTAMPTZ,
  completed_at TIMESTAMPTZ
);

-- Ğ›Ğ¾Ğ³ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ñ… ÑĞºĞ·ĞµĞ¼Ğ¿Ğ»ÑÑ€Ğ¾Ğ²
CREATE TABLE migration_logs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  migration_plan_id UUID NOT NULL REFERENCES migration_plans(id) ON DELETE CASCADE,
  process_instance_key VARCHAR(255) NOT NULL,

  status VARCHAR(50) NOT NULL,  -- 'success', 'failed', 'skipped'
  error_message TEXT,
  migrated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_migration_logs_plan ON migration_logs(migration_plan_id);
```

### 8.3 Backend: MigrationService

```typescript
@Injectable()
export class ProcessMigrationService {
  constructor(
    private bpmnService: BpmnService,
    @InjectRepository(MigrationPlan)
    private migrationPlanRepository: Repository<MigrationPlan>,
  ) {}

  /**
   * Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ğ»Ğ°Ğ½ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¼ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸ĞµĞ¼ Ğ¼Ğ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³Ğ°
   */
  async createMigrationPlan(
    sourceDefinitionKey: string,
    sourceVersion: number,
    targetDefinitionKey: string,
    targetVersion: number,
  ): Promise<MigrationPlan> {
    // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ XML Ğ¾Ğ±ĞµĞ¸Ñ… Ğ²ĞµÑ€ÑĞ¸Ğ¹
    const [sourceXml, targetXml] = await Promise.all([
      this.getVersionXml(sourceDefinitionKey, sourceVersion),
      this.getVersionXml(targetDefinitionKey, targetVersion),
    ]);

    // ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸Ñ‚ÑŒ Ğ¼Ğ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
    const elementMappings = this.detectElementMappings(sourceXml, targetXml);

    // ĞĞ°Ğ¹Ñ‚Ğ¸ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ±ĞµĞ· Ğ¼Ğ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³Ğ° (Ñ‚Ñ€ĞµĞ±ÑƒÑÑ‚ Ñ€ÑƒÑ‡Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ğ¼ĞµÑˆĞ°Ñ‚ĞµĞ»ÑŒÑÑ‚Ğ²Ğ°)
    const unmappedElements = this.findUnmappedElements(sourceXml, elementMappings);

    const plan = this.migrationPlanRepository.create({
      sourceDefinitionKey,
      sourceVersion,
      targetDefinitionKey,
      targetVersion,
      elementMappings,
      status: unmappedElements.length > 0 ? 'draft' : 'ready',
    });

    return this.migrationPlanRepository.save(plan);
  }

  /**
   * Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ
   */
  async executeMigration(planId: string): Promise<void> {
    const plan = await this.migrationPlanRepository.findOneOrFail({
      where: { id: planId },
    });

    if (plan.status !== 'ready') {
      throw new BadRequestException('Migration plan is not ready');
    }

    await this.migrationPlanRepository.update(planId, {
      status: 'in_progress',
      executedAt: new Date(),
    });

    try {
      // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ ÑĞºĞ·ĞµĞ¼Ğ¿Ğ»ÑÑ€Ñ‹ Ğ¸ÑÑ…Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ²ĞµÑ€ÑĞ¸Ğ¸
      const instances = await this.bpmnService.findActiveInstances(
        plan.sourceDefinitionKey,
        plan.sourceVersion,
      );

      plan.totalInstances = instances.length;

      for (const instance of instances) {
        try {
          await this.migrateInstance(instance, plan);
          plan.migratedInstances++;
        } catch (error) {
          plan.failedInstances++;
          await this.logMigrationError(plan.id, instance.key, error.message);
        }
      }

      await this.migrationPlanRepository.update(planId, {
        status: plan.failedInstances > 0 ? 'completed_with_errors' : 'completed',
        completedAt: new Date(),
        totalInstances: plan.totalInstances,
        migratedInstances: plan.migratedInstances,
        failedInstances: plan.failedInstances,
      });
    } catch (error) {
      await this.migrationPlanRepository.update(planId, {
        status: 'failed',
      });
      throw error;
    }
  }

  private async migrateInstance(
    instance: ProcessInstance,
    plan: MigrationPlan,
  ): Promise<void> {
    const zeebeClient = this.bpmnService.getZeebeClient();

    // Camunda 8 Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· API
    await zeebeClient.migrateProcessInstance({
      processInstanceKey: instance.processInstanceKey,
      migrationPlan: {
        targetProcessDefinitionKey: plan.targetDefinitionKey,
        mappingInstructions: plan.elementMappings.map(m => ({
          sourceElementId: m.source,
          targetElementId: m.target,
        })),
      },
    });

    // ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾
    if (plan.variableUpdates) {
      await this.updateInstanceVariables(instance.processInstanceKey, plan.variableUpdates);
    }

    await this.logMigrationSuccess(plan.id, instance.processInstanceKey);
  }

  /**
   * ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¼Ğ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³Ğ° ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
   */
  private detectElementMappings(
    sourceXml: string,
    targetXml: string,
  ): ElementMapping[] {
    const sourceElements = this.parseElements(sourceXml);
    const targetElements = this.parseElements(targetXml);

    const mappings: ElementMapping[] = [];

    for (const sourceEl of sourceElements) {
      // Ğ¢Ğ¾Ñ‡Ğ½Ğ¾Ğµ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ ID
      const exactMatch = targetElements.find(t => t.id === sourceEl.id);
      if (exactMatch) {
        mappings.push({ source: sourceEl.id, target: exactMatch.id, confidence: 1 });
        continue;
      }

      // ĞŸĞ¾Ñ…Ğ¾Ğ¶ĞµĞµ Ğ¸Ğ¼Ñ
      const nameMatch = targetElements.find(t =>
        t.name && sourceEl.name &&
        this.similarity(t.name, sourceEl.name) > 0.8
      );
      if (nameMatch) {
        mappings.push({
          source: sourceEl.id,
          target: nameMatch.id,
          confidence: 0.8,
        });
      }
    }

    return mappings;
  }

  private similarity(a: string, b: string): number {
    // Levenshtein distance normalized
    // Simplified implementation
    if (a === b) return 1;
    if (a.toLowerCase() === b.toLowerCase()) return 0.95;
    return 0;
  }
}
```

---

## 9. ĞšĞ¾Ğ¼Ğ¿ĞµĞ½ÑĞ°Ñ†Ğ¸Ğ¸ Ğ¸ Ğ¾Ñ‚ĞºĞ°Ñ‚

### 9.1 ĞšĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ

ĞšĞ¾Ğ¼Ğ¿ĞµĞ½ÑĞ°Ñ†Ğ¸Ñ â€” ÑÑ‚Ğ¾ Ğ¾Ñ‚Ğ¼ĞµĞ½Ğ° ÑÑ„Ñ„ĞµĞºÑ‚Ğ¾Ğ² ÑƒĞ¶Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ½Ñ‹Ñ… Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğ¹ Ğ¿Ñ€Ğ¸ Ğ²Ğ¾Ğ·Ğ½Ğ¸ĞºĞ½Ğ¾Ğ²ĞµĞ½Ğ¸Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸. ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€:
- Ğ¡Ğ¿Ğ¸ÑĞ°Ğ»Ğ¸ Ğ´ĞµĞ½ÑŒĞ³Ğ¸ â†’ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ´Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ¸ â†’ Ğ’ĞµÑ€Ğ½ÑƒÑ‚ÑŒ Ğ´ĞµĞ½ÑŒĞ³Ğ¸
- Ğ—Ğ°Ğ±Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ»Ğ¸ Ğ½Ğ¾Ğ¼ĞµÑ€ â†’ ĞÑ‚Ğ¼ĞµĞ½Ğ° Ñ€ĞµĞ¹ÑĞ° â†’ ĞÑ‚Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ±Ñ€Ğ¾Ğ½ÑŒ

### 9.2 BPMN Compensation Events

```xml
<!-- ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ° Ñ ĞºĞ¾Ğ¼Ğ¿ĞµĞ½ÑĞ°Ñ†Ğ¸ĞµĞ¹ -->
<bpmn:process id="order-with-compensation">
  <bpmn:startEvent id="start" />

  <!-- Ğ¨Ğ°Ğ³ 1: Ğ¡Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñ‹ -->
  <bpmn:serviceTask id="chargePayment" name="Ğ¡Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñƒ">
    <bpmn:extensionElements>
      <zeebe:taskDefinition type="payment:charge" />
    </bpmn:extensionElements>
  </bpmn:serviceTask>

  <!-- ĞšĞ¾Ğ¼Ğ¿ĞµĞ½ÑĞ¸Ñ€ÑƒÑÑ‰ĞµĞµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ Ğ´Ğ»Ñ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñ‹ -->
  <bpmn:boundaryEvent id="compensatePayment" attachedToRef="chargePayment">
    <bpmn:compensateEventDefinition />
  </bpmn:boundaryEvent>

  <!-- ĞšĞ¾Ğ¼Ğ¿ĞµĞ½ÑĞ¸Ñ€ÑƒÑÑ‰Ğ°Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ° -->
  <bpmn:serviceTask id="refundPayment" name="Ğ’ĞµÑ€Ğ½ÑƒÑ‚ÑŒ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñƒ" isForCompensation="true">
    <bpmn:extensionElements>
      <zeebe:taskDefinition type="payment:refund" />
    </bpmn:extensionElements>
  </bpmn:serviceTask>

  <bpmn:association associationDirection="One" sourceRef="compensatePayment" targetRef="refundPayment" />

  <!-- Ğ¨Ğ°Ğ³ 2: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ° -->
  <bpmn:serviceTask id="createOrder" name="Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ·Ğ°ĞºĞ°Ğ·">
    <bpmn:extensionElements>
      <zeebe:taskDefinition type="order:create" />
    </bpmn:extensionElements>
  </bpmn:serviceTask>

  <!-- Ğ¨Ğ°Ğ³ 3: Ğ”Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ° (Ğ¼Ğ¾Ğ¶ĞµÑ‚ ÑƒĞ¿Ğ°ÑÑ‚ÑŒ) -->
  <bpmn:serviceTask id="shipOrder" name="ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ°ĞºĞ°Ğ·">
    <bpmn:extensionElements>
      <zeebe:taskDefinition type="shipping:send" />
    </bpmn:extensionElements>
  </bpmn:serviceTask>

  <!-- ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ Ğ´Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ¸ -->
  <bpmn:boundaryEvent id="shippingError" attachedToRef="shipOrder">
    <bpmn:errorEventDefinition errorRef="ShippingFailed" />
  </bpmn:boundaryEvent>

  <!-- ĞŸÑ€Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞµ - Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ¼Ğ¿ĞµĞ½ÑĞ°Ñ†Ğ¸Ñ -->
  <bpmn:intermediateThrowEvent id="triggerCompensation" name="ĞÑ‚ĞºĞ°Ñ‚Ğ¸Ñ‚ÑŒ">
    <bpmn:compensateEventDefinition />
  </bpmn:intermediateThrowEvent>

  <bpmn:endEvent id="endSuccess" />
  <bpmn:endEvent id="endFailed" />

  <!-- Flows -->
  <bpmn:sequenceFlow sourceRef="start" targetRef="chargePayment" />
  <bpmn:sequenceFlow sourceRef="chargePayment" targetRef="createOrder" />
  <bpmn:sequenceFlow sourceRef="createOrder" targetRef="shipOrder" />
  <bpmn:sequenceFlow sourceRef="shipOrder" targetRef="endSuccess" />
  <bpmn:sequenceFlow sourceRef="shippingError" targetRef="triggerCompensation" />
  <bpmn:sequenceFlow sourceRef="triggerCompensation" targetRef="endFailed" />
</bpmn:process>

<bpmn:error id="ShippingFailed" name="Shipping Failed" errorCode="SHIPPING_FAILED" />
```

### 9.3 Workers Ğ´Ğ»Ñ ĞºĞ¾Ğ¼Ğ¿ĞµĞ½ÑĞ°Ñ†Ğ¸Ğ¸

```typescript
// ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ worker: ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñ‹
zeebeClient.createWorker({
  taskType: 'payment:charge',
  taskHandler: async (job) => {
    const { orderId, amount, customerId } = job.variables;

    const transaction = await this.paymentService.charge(customerId, amount);

    // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ transactionId Ğ´Ğ»Ñ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ¼Ğ¿ĞµĞ½ÑĞ°Ñ†Ğ¸Ğ¸
    return job.complete({
      transactionId: transaction.id,
      chargedAmount: amount,
    });
  },
});

// ĞšĞ¾Ğ¼Ğ¿ĞµĞ½ÑĞ¸Ñ€ÑƒÑÑ‰Ğ¸Ğ¹ worker: Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñ‹
zeebeClient.createWorker({
  taskType: 'payment:refund',
  taskHandler: async (job) => {
    const { transactionId, chargedAmount } = job.variables;

    // Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸Ğ· Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ´Ğ»Ñ Ğ¾Ñ‚ĞºĞ°Ñ‚Ğ°
    await this.paymentService.refund(transactionId, chargedAmount);

    return job.complete({ refunded: true });
  },
});
```

### 9.4 Saga Pattern Ğ´Ğ»Ñ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ñ‹Ñ… Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¹

```typescript
interface SagaStep {
  name: string;
  execute: (context: Record<string, any>) => Promise<Record<string, any>>;
  compensate: (context: Record<string, any>) => Promise<void>;
}

class SagaOrchestrator {
  private steps: SagaStep[] = [];
  private completedSteps: SagaStep[] = [];

  addStep(step: SagaStep) {
    this.steps.push(step);
    return this;
  }

  async execute(initialContext: Record<string, any>): Promise<Record<string, any>> {
    let context = { ...initialContext };

    for (const step of this.steps) {
      try {
        const result = await step.execute(context);
        context = { ...context, ...result };
        this.completedSteps.push(step);
      } catch (error) {
        // ĞÑ‚ĞºĞ°Ñ‚Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ½Ñ‹Ğµ ÑˆĞ°Ğ³Ğ¸ Ğ² Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ğ¾Ğ¼ Ğ¿Ğ¾Ñ€ÑĞ´ĞºĞµ
        await this.compensate(context);
        throw error;
      }
    }

    return context;
  }

  private async compensate(context: Record<string, any>): Promise<void> {
    for (const step of this.completedSteps.reverse()) {
      try {
        await step.compensate(context);
      } catch (error) {
        // Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¾ÑˆĞ¸Ğ±ĞºÑƒ ĞºĞ¾Ğ¼Ğ¿ĞµĞ½ÑĞ°Ñ†Ğ¸Ğ¸, Ğ½Ğ¾ Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°Ñ‚ÑŒ
        console.error(`Compensation failed for ${step.name}:`, error);
      }
    }
  }
}

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
const orderSaga = new SagaOrchestrator()
  .addStep({
    name: 'reserve-inventory',
    execute: async (ctx) => {
      const reservation = await inventoryService.reserve(ctx.items);
      return { reservationId: reservation.id };
    },
    compensate: async (ctx) => {
      await inventoryService.cancelReservation(ctx.reservationId);
    },
  })
  .addStep({
    name: 'charge-payment',
    execute: async (ctx) => {
      const payment = await paymentService.charge(ctx.customerId, ctx.total);
      return { paymentId: payment.id };
    },
    compensate: async (ctx) => {
      await paymentService.refund(ctx.paymentId);
    },
  })
  .addStep({
    name: 'create-shipment',
    execute: async (ctx) => {
      const shipment = await shippingService.create(ctx.address, ctx.items);
      return { shipmentId: shipment.id };
    },
    compensate: async (ctx) => {
      await shippingService.cancel(ctx.shipmentId);
    },
  });

// Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ
try {
  const result = await orderSaga.execute({
    customerId: '123',
    items: [{ sku: 'ABC', qty: 2 }],
    total: 100,
    address: '...',
  });
} catch (error) {
  // Saga Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¾Ñ‚ĞºĞ°Ñ‚Ğ¸Ñ‚ Ğ²ÑĞµ ÑˆĞ°Ğ³Ğ¸
}
```

---

## 10. ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ğ¸ Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚Ñ‹

### 10.1 ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²

| ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ° | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ° |
|---------|----------|---------|
| **Throughput** | ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ·Ğ°Ğ²ĞµÑ€ÑˆÑ‘Ğ½Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² | COUNT(completed) / period |
| **Cycle Time** | Ğ’Ñ€ĞµĞ¼Ñ Ğ¾Ñ‚ ÑÑ‚Ğ°Ñ€Ñ‚Ğ° Ğ´Ğ¾ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ | AVG(completedAt - startedAt) |
| **Lead Time** | Ğ’Ñ€ĞµĞ¼Ñ Ğ¾Ñ‚ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ·Ğ°ÑĞ²ĞºĞ¸ Ğ´Ğ¾ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ | AVG(process.completedAt - entity.createdAt) |
| **Wait Time** | Ğ’Ñ€ĞµĞ¼Ñ Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ñ Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑÑ… | SUM(task.claimedAt - task.createdAt) |
| **Touch Time** | Ğ¤Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ²Ñ€ĞµĞ¼Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ | SUM(task.completedAt - task.claimedAt) |
| **Efficiency** | Ğ­Ñ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ° | TouchTime / CycleTime * 100% |
| **First Pass Yield** | % Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² Ğ±ĞµĞ· Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚Ğ¾Ğ² | COUNT(no_rework) / COUNT(total) |
| **SLA Compliance** | % Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ SLA | COUNT(sla_met) / COUNT(total) |

### 10.2 ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸

```sql
-- Materialized view Ğ´Ğ»Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²
CREATE MATERIALIZED VIEW mv_process_statistics AS
SELECT
  pd.workspace_id,
  pd.id AS process_definition_id,
  pd.name AS process_name,

  -- ĞĞ±Ñ‰Ğ¸Ğµ ÑÑ‡Ñ‘Ñ‚Ñ‡Ğ¸ĞºĞ¸
  COUNT(pi.id) AS total_instances,
  COUNT(CASE WHEN pi.status = 'completed' THEN 1 END) AS completed_instances,
  COUNT(CASE WHEN pi.status = 'active' THEN 1 END) AS active_instances,
  COUNT(CASE WHEN pi.status = 'incident' THEN 1 END) AS incident_instances,

  -- Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ (Ğ² Ğ¼Ğ¸Ğ½ÑƒÑ‚Ğ°Ñ…)
  AVG(EXTRACT(EPOCH FROM (pi.completed_at - pi.started_at)) / 60)
    FILTER (WHERE pi.status = 'completed') AS avg_cycle_time_minutes,

  PERCENTILE_CONT(0.5) WITHIN GROUP (
    ORDER BY EXTRACT(EPOCH FROM (pi.completed_at - pi.started_at)) / 60
  ) FILTER (WHERE pi.status = 'completed') AS median_cycle_time_minutes,

  PERCENTILE_CONT(0.95) WITHIN GROUP (
    ORDER BY EXTRACT(EPOCH FROM (pi.completed_at - pi.started_at)) / 60
  ) FILTER (WHERE pi.status = 'completed') AS p95_cycle_time_minutes,

  -- Ğ—Ğ° Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´
  COUNT(pi.id) FILTER (WHERE pi.started_at > NOW() - INTERVAL '24 hours') AS instances_24h,
  COUNT(pi.id) FILTER (WHERE pi.started_at > NOW() - INTERVAL '7 days') AS instances_7d,
  COUNT(pi.id) FILTER (WHERE pi.started_at > NOW() - INTERVAL '30 days') AS instances_30d

FROM process_definitions pd
LEFT JOIN process_instances pi ON pi.process_definition_id = pd.id
GROUP BY pd.workspace_id, pd.id, pd.name;

CREATE UNIQUE INDEX idx_mv_process_stats_id ON mv_process_statistics(process_definition_id);

-- Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ°Ğ¼ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ° (Ğ´Ğ»Ñ Ñ‚ĞµĞ¿Ğ»Ğ¾Ğ²Ğ¾Ğ¹ ĞºĞ°Ñ€Ñ‚Ñ‹)
CREATE MATERIALIZED VIEW mv_element_statistics AS
SELECT
  pi.process_definition_id,
  el.element_id,
  el.element_name,
  el.element_type,

  COUNT(*) AS execution_count,
  AVG(el.duration_ms) AS avg_duration_ms,
  PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY el.duration_ms) AS p95_duration_ms,

  COUNT(CASE WHEN el.status = 'incident' THEN 1 END) AS incident_count

FROM process_instances pi
CROSS JOIN LATERAL jsonb_to_recordset(pi.element_history) AS el(
  element_id TEXT,
  element_name TEXT,
  element_type TEXT,
  started_at TIMESTAMPTZ,
  completed_at TIMESTAMPTZ,
  duration_ms INT,
  status TEXT
)
WHERE pi.completed_at > NOW() - INTERVAL '30 days'
GROUP BY pi.process_definition_id, el.element_id, el.element_name, el.element_type;

CREATE INDEX idx_mv_element_stats ON mv_element_statistics(process_definition_id);

-- Ğ•Ğ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ğ°Ñ Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ†Ğ¸Ñ
CREATE TABLE daily_process_metrics (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  date DATE NOT NULL,
  workspace_id UUID NOT NULL REFERENCES workspaces(id),
  process_definition_id UUID REFERENCES process_definitions(id),

  -- Ğ¡Ñ‡Ñ‘Ñ‚Ñ‡Ğ¸ĞºĞ¸
  started_count INT DEFAULT 0,
  completed_count INT DEFAULT 0,
  incident_count INT DEFAULT 0,

  -- Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ° (Ğ² Ğ¼Ğ¸Ğ½ÑƒÑ‚Ğ°Ñ…)
  avg_cycle_time NUMERIC(10,2),
  min_cycle_time NUMERIC(10,2),
  max_cycle_time NUMERIC(10,2),

  -- SLA
  sla_met_count INT DEFAULT 0,
  sla_breached_count INT DEFAULT 0,

  created_at TIMESTAMPTZ DEFAULT NOW(),

  UNIQUE(date, workspace_id, process_definition_id)
);

CREATE INDEX idx_daily_metrics_date ON daily_process_metrics(date);
CREATE INDEX idx_daily_metrics_workspace ON daily_process_metrics(workspace_id);
```

### 10.3 Backend: AnalyticsModule

```
apps/backend/src/modules/analytics/
â”œâ”€â”€ analytics.module.ts
â”œâ”€â”€ analytics.service.ts
â”œâ”€â”€ process-mining.service.ts    # Process mining Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ñ‹
â”œâ”€â”€ analytics.controller.ts
â”œâ”€â”€ jobs/
â”‚   â”œâ”€â”€ refresh-views.job.ts     # ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ materialized views
â”‚   â””â”€â”€ aggregate-daily.job.ts   # Ğ•Ğ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ğ°Ñ Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ†Ğ¸Ñ
â””â”€â”€ dto/
    â””â”€â”€ analytics-query.dto.ts
```

#### process-mining.service.ts

```typescript
@Injectable()
export class ProcessMiningService {
  /**
   * ĞŸĞ¾ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Ğ³Ñ€Ğ°Ñ„ Ñ„Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²
   */
  async discoverProcessModel(
    definitionId: string,
    dateFrom: Date,
    dateTo: Date,
  ): Promise<ProcessModel> {
    // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆÑ‘Ğ½Ğ½Ñ‹Ğµ ÑĞºĞ·ĞµĞ¼Ğ¿Ğ»ÑÑ€Ñ‹
    const instances = await this.processInstanceRepository.find({
      where: {
        processDefinitionId: definitionId,
        status: 'completed',
        completedAt: Between(dateFrom, dateTo),
      },
    });

    // ĞŸĞ¾ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Ğ³Ñ€Ğ°Ñ„ Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¾Ğ²
    const transitions: Map<string, Map<string, number>> = new Map();
    const elementCounts: Map<string, number> = new Map();

    for (const instance of instances) {
      const elements = instance.elementHistory || [];

      for (let i = 0; i < elements.length - 1; i++) {
        const from = elements[i].elementId;
        const to = elements[i + 1].elementId;

        // Ğ¡Ñ‡Ñ‘Ñ‚Ñ‡Ğ¸Ğº ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
        elementCounts.set(from, (elementCounts.get(from) || 0) + 1);

        // Ğ¡Ñ‡Ñ‘Ñ‚Ñ‡Ğ¸Ğº Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¾Ğ²
        if (!transitions.has(from)) {
          transitions.set(from, new Map());
        }
        const fromTransitions = transitions.get(from)!;
        fromTransitions.set(to, (fromTransitions.get(to) || 0) + 1);
      }

      // ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğ¹ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚
      const last = elements[elements.length - 1]?.elementId;
      if (last) {
        elementCounts.set(last, (elementCounts.get(last) || 0) + 1);
      }
    }

    return {
      elements: Array.from(elementCounts.entries()).map(([id, count]) => ({
        id,
        count,
        frequency: count / instances.length,
      })),
      transitions: Array.from(transitions.entries()).flatMap(([from, toMap]) =>
        Array.from(toMap.entries()).map(([to, count]) => ({
          from,
          to,
          count,
          frequency: count / instances.length,
        }))
      ),
      totalInstances: instances.length,
    };
  }

  /**
   * ĞĞ°Ğ¹Ñ‚Ğ¸ ÑƒĞ·ĞºĞ¸Ğµ Ğ¼ĞµÑÑ‚Ğ° (bottlenecks)
   */
  async findBottlenecks(
    definitionId: string,
    dateFrom: Date,
    dateTo: Date,
  ): Promise<Bottleneck[]> {
    const stats = await this.getElementStatistics(definitionId, dateFrom, dateTo);

    // Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¿Ğ¾ ÑÑ€ĞµĞ´Ğ½ĞµĞ¼Ñƒ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ
    const sorted = stats.sort((a, b) => b.avgDurationMs - a.avgDurationMs);

    // Ğ‘ĞµÑ€Ñ‘Ğ¼ Ñ‚Ğ¾Ğ¿-5 ÑĞ°Ğ¼Ñ‹Ñ… Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ñ…
    return sorted.slice(0, 5).map((el, index) => ({
      elementId: el.elementId,
      elementName: el.elementName,
      avgDurationMs: el.avgDurationMs,
      p95DurationMs: el.p95DurationMs,
      executionCount: el.executionCount,
      impact: this.calculateImpact(el, stats),
      rank: index + 1,
      suggestions: this.generateSuggestions(el),
    }));
  }

  /**
   * ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ°Ğ½Ğ¾Ğ¼Ğ°Ğ»Ğ¸Ğ¸ (outliers)
   */
  async findAnomalies(
    definitionId: string,
    dateFrom: Date,
    dateTo: Date,
  ): Promise<Anomaly[]> {
    const instances = await this.processInstanceRepository.find({
      where: {
        processDefinitionId: definitionId,
        completedAt: Between(dateFrom, dateTo),
      },
    });

    // Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸
    const cycleTimes = instances
      .filter(i => i.completedAt && i.startedAt)
      .map(i => differenceInMinutes(i.completedAt!, i.startedAt!));

    const mean = cycleTimes.reduce((a, b) => a + b, 0) / cycleTimes.length;
    const std = Math.sqrt(
      cycleTimes.reduce((sq, n) => sq + Math.pow(n - mean, 2), 0) / cycleTimes.length
    );

    // ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ²Ñ‹Ğ±Ñ€Ğ¾ÑÑ‹ (> 2 ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ñ… Ğ¾Ñ‚ĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¸Ñ)
    const anomalies: Anomaly[] = [];
    for (const instance of instances) {
      if (!instance.completedAt || !instance.startedAt) continue;

      const cycleTime = differenceInMinutes(instance.completedAt, instance.startedAt);
      const zScore = (cycleTime - mean) / std;

      if (Math.abs(zScore) > 2) {
        anomalies.push({
          instanceId: instance.id,
          instanceKey: instance.processInstanceKey,
          cycleTimeMinutes: cycleTime,
          expectedMinutes: mean,
          deviation: zScore,
          type: zScore > 0 ? 'slow' : 'fast',
        });
      }
    }

    return anomalies.sort((a, b) => Math.abs(b.deviation) - Math.abs(a.deviation));
  }

  private calculateImpact(element: ElementStats, allStats: ElementStats[]): number {
    const totalTime = allStats.reduce((sum, el) => sum + el.avgDurationMs * el.executionCount, 0);
    const elementTime = element.avgDurationMs * element.executionCount;
    return (elementTime / totalTime) * 100;
  }

  private generateSuggestions(element: ElementStats): string[] {
    const suggestions: string[] = [];

    if (element.avgDurationMs > 60000) {
      suggestions.push('Ğ Ğ°ÑÑĞ¼Ğ¾Ñ‚Ñ€Ğ¸Ñ‚Ğµ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ÑÑ‚Ğ¾Ğ³Ğ¾ ÑˆĞ°Ğ³Ğ°');
    }

    if (element.p95DurationMs / element.avgDurationMs > 3) {
      suggestions.push('Ğ’Ñ‹ÑĞ¾ĞºĞ°Ñ Ğ²Ğ°Ñ€Ğ¸Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ â€” Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ¿Ñ€Ğ¸Ñ‡Ğ¸Ğ½Ñ‹ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞµĞº');
    }

    if (element.elementType === 'userTask') {
      suggestions.push('ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¸ SLA Ğ´Ğ»Ñ ÑÑ‚Ğ¾Ğ¹ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸');
    }

    return suggestions;
  }
}
```

### 10.4 API Endpoints

```typescript
@Controller('analytics')
@UseGuards(JwtAuthGuard)
export class AnalyticsController {
  // Dashboard Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸
  @Get('dashboard')
  async getDashboard(
    @Query('workspaceId') workspaceId: string,
    @Query('from') from: string,
    @Query('to') to: string,
  ) {}

  // Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑÑƒ
  @Get('process/:definitionId')
  async getProcessStats(
    @Param('definitionId') definitionId: string,
    @Query('from') from: string,
    @Query('to') to: string,
  ) {}

  // Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ Ñ‚ĞµĞ¿Ğ»Ğ¾Ğ²Ğ¾Ğ¹ ĞºĞ°Ñ€Ñ‚Ñ‹
  @Get('process/:definitionId/heatmap')
  async getHeatmapData(@Param('definitionId') definitionId: string) {}

  // Process mining: Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ½Ğ°Ñ Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ
  @Get('process/:definitionId/discovered-model')
  async getDiscoveredModel(
    @Param('definitionId') definitionId: string,
    @Query('from') from: string,
    @Query('to') to: string,
  ) {}

  // Ğ£Ğ·ĞºĞ¸Ğµ Ğ¼ĞµÑÑ‚Ğ°
  @Get('process/:definitionId/bottlenecks')
  async getBottlenecks(@Param('definitionId') definitionId: string) {}

  // ĞĞ½Ğ¾Ğ¼Ğ°Ğ»Ğ¸Ğ¸
  @Get('process/:definitionId/anomalies')
  async getAnomalies(@Param('definitionId') definitionId: string) {}

  // Ğ¢Ñ€ĞµĞ½Ğ´Ñ‹
  @Get('trends')
  async getTrends(
    @Query('workspaceId') workspaceId: string,
    @Query('metric') metric: string,
    @Query('granularity') granularity: 'hour' | 'day' | 'week' | 'month',
  ) {}

  // Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚Ğ°
  @Get('report/export')
  async exportReport(
    @Query('workspaceId') workspaceId: string,
    @Query('format') format: 'pdf' | 'xlsx' | 'csv',
  ) {}
}
```

### 10.5 Frontend: UI ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

```
apps/frontend/src/components/analytics/
â”œâ”€â”€ AnalyticsDashboard.tsx       # Ğ“Ğ»Ğ°Ğ²Ğ½Ñ‹Ğ¹ dashboard
â”œâ”€â”€ ProcessMetricsCard.tsx       # ĞšĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ° Ñ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ°Ğ¼Ğ¸ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ°
â”œâ”€â”€ TrendChart.tsx               # Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº Ñ‚Ñ€ĞµĞ½Ğ´Ğ¾Ğ²
â”œâ”€â”€ BottlenecksTable.tsx         # Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° ÑƒĞ·ĞºĞ¸Ñ… Ğ¼ĞµÑÑ‚
â”œâ”€â”€ AnomaliesAlert.tsx           # ĞĞ»ĞµÑ€Ñ‚ Ğ¾Ğ± Ğ°Ğ½Ğ¾Ğ¼Ğ°Ğ»Ğ¸ÑÑ…
â”œâ”€â”€ ProcessMiningView.tsx        # Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ process mining
â”œâ”€â”€ SlaComplianceChart.tsx       # Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° SLA compliance
â”œâ”€â”€ CycleTimeDistribution.tsx    # Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ cycle time
â””â”€â”€ hooks/
    â”œâ”€â”€ useAnalytics.ts
    â””â”€â”€ useProcessMining.ts
```

---

## 11. Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½Ñ‹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²

### 11.1 ĞšĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ

Ğ‘Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ° Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ñ‹Ñ… BPMN-Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² Ğ´Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ ÑÑ‚Ğ°Ñ€Ñ‚Ğ°:
- ĞŸÑ€ĞµĞ´Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑÑ‹ Ğ´Ğ»Ñ Ñ‚Ğ¸Ğ¿Ğ¾Ğ²Ñ‹Ñ… ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸ĞµĞ²
- Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
- Ğ’ĞµÑ€ÑĞ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ¾Ğ²

### 11.2 ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```sql
-- Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½Ñ‹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²
CREATE TABLE process_templates (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

  -- NULL = Ğ³Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½, Ğ¸Ğ½Ğ°Ñ‡Ğµ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½ workspace
  workspace_id UUID REFERENCES workspaces(id),

  name VARCHAR(255) NOT NULL,
  description TEXT,
  category VARCHAR(100),  -- 'approval', 'support', 'hr', 'finance', 'custom'

  -- BPMN
  bpmn_xml TEXT NOT NULL,
  thumbnail_url TEXT,  -- ĞŸÑ€ĞµĞ²ÑŒÑ Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹

  -- ĞœĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
  tags TEXT[],
  variables_schema JSONB,  -- JSON Schema Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ñ…
  required_connectors TEXT[],  -- ['email', 'telegram']

  -- Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
  usage_count INT DEFAULT 0,
  rating NUMERIC(3,2),  -- Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹ Ñ€ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³ 1-5

  is_public BOOLEAN DEFAULT false,
  is_featured BOOLEAN DEFAULT false,

  created_by_id UUID REFERENCES users(id),
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_process_templates_category ON process_templates(category);
CREATE INDEX idx_process_templates_tags ON process_templates USING GIN(tags);

-- ĞÑ‚Ğ·Ñ‹Ğ²Ñ‹ Ğ½Ğ° ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ñ‹
CREATE TABLE template_reviews (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  template_id UUID NOT NULL REFERENCES process_templates(id) ON DELETE CASCADE,
  user_id UUID NOT NULL REFERENCES users(id),

  rating INT NOT NULL CHECK (rating >= 1 AND rating <= 5),
  comment TEXT,

  created_at TIMESTAMPTZ DEFAULT NOW(),

  UNIQUE(template_id, user_id)
);
```

### 11.3 ĞŸÑ€ĞµĞ´ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğµ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ñ‹

```typescript
const builtInTemplates: ProcessTemplate[] = [
  {
    id: 'approval-3-level',
    name: 'Ğ¡Ğ¾Ğ³Ğ»Ğ°ÑĞ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² 3 ÑƒÑ€Ğ¾Ğ²Ğ½Ñ',
    description: 'ĞŸĞ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ ÑĞ¾Ğ³Ğ»Ğ°ÑĞ¾Ğ²Ğ°Ğ½Ğ¸Ğµ: Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒ â†’ Ñ€ÑƒĞºĞ¾Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒ â†’ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€',
    category: 'approval',
    tags: ['ÑĞ¾Ğ³Ğ»Ğ°ÑĞ¾Ğ²Ğ°Ğ½Ğ¸Ğµ', 'approval', 'Ğ¸ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ'],
    bpmnXml: `...`, // BPMN XML
    variablesSchema: {
      type: 'object',
      properties: {
        requestTitle: { type: 'string', title: 'ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ÑĞ²ĞºĞ¸' },
        amount: { type: 'number', title: 'Ğ¡ÑƒĞ¼Ğ¼Ğ°' },
        level1Approver: { type: 'string', title: 'Ğ¡Ğ¾Ğ³Ğ»Ğ°ÑÑƒÑÑ‰Ğ¸Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ 1' },
        level2Approver: { type: 'string', title: 'Ğ¡Ğ¾Ğ³Ğ»Ğ°ÑÑƒÑÑ‰Ğ¸Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ 2' },
        level3Approver: { type: 'string', title: 'Ğ¡Ğ¾Ğ³Ğ»Ğ°ÑÑƒÑÑ‰Ğ¸Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ 3' },
      },
    },
  },
  {
    id: 'support-ticket',
    name: 'ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾Ğ±Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ñ',
    description: 'Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ¾Ğ±Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ñ Ğ² ÑĞ»ÑƒĞ¶Ğ±Ñƒ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ¸',
    category: 'support',
    tags: ['support', 'helpdesk', 'ticket'],
    bpmnXml: `...`,
  },
  {
    id: 'employee-onboarding',
    name: 'ĞĞ½Ğ±Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ³ ÑĞ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸ĞºĞ°',
    description: 'ĞŸÑ€Ğ¾Ñ†ĞµÑÑ Ğ°Ğ´Ğ°Ğ¿Ñ‚Ğ°Ñ†Ğ¸Ğ¸ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ ÑĞ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸ĞºĞ°',
    category: 'hr',
    tags: ['hr', 'onboarding', 'hiring'],
    bpmnXml: `...`,
  },
  {
    id: 'purchase-request',
    name: 'Ğ—Ğ°ÑĞ²ĞºĞ° Ğ½Ğ° Ğ·Ğ°ĞºÑƒĞ¿ĞºÑƒ',
    description: 'ĞŸÑ€Ğ¾Ñ†ĞµÑÑ ÑĞ¾Ğ³Ğ»Ğ°ÑĞ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¸ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ Ğ·Ğ°ĞºÑƒĞ¿ĞºĞ¸',
    category: 'finance',
    tags: ['Ğ·Ğ°ĞºÑƒĞ¿ĞºĞ°', 'purchase', 'procurement'],
    bpmnXml: `...`,
  },
  {
    id: 'document-review',
    name: 'Ğ¡Ğ¾Ğ³Ğ»Ğ°ÑĞ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°',
    description: 'ĞŸĞ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ¾Ğµ ÑĞ¾Ğ³Ğ»Ğ°ÑĞ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ° Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ğ¼Ğ¸ ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ°Ğ¼Ğ¸',
    category: 'approval',
    tags: ['Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚', 'ÑĞ¾Ğ³Ğ»Ğ°ÑĞ¾Ğ²Ğ°Ğ½Ğ¸Ğµ', 'parallel'],
    bpmnXml: `...`,
  },
  {
    id: 'incident-management',
    name: 'Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¸Ğ½Ñ†Ğ¸Ğ´ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸',
    description: 'ITIL-ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¸Ğ½Ñ†Ğ¸Ğ´ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸',
    category: 'support',
    tags: ['itil', 'incident', 'sla'],
    bpmnXml: `...`,
  },
];
```

### 11.4 API Endpoints

```typescript
@Controller('templates')
export class TemplatesController {
  // Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ¾Ğ²
  @Get()
  async findAll(
    @Query('category') category?: string,
    @Query('search') search?: string,
    @Query('tags') tags?: string[],
  ) {}

  // Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ°
  @Get(':id')
  async findOne(@Param('id') id: string) {}

  // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ Ğ¸Ğ· ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ°
  @Post(':id/instantiate')
  async instantiate(
    @Param('id') id: string,
    @Body() dto: InstantiateTemplateDto,
    @CurrentUser() user: User,
  ) {
    // ĞšĞ¾Ğ¿Ğ¸Ñ€ÑƒĞµÑ‚ BPMN Ğ¸Ğ· ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ° Ğ² Ğ½Ğ¾Ğ²Ñ‹Ğ¹ ProcessDefinition
    // ĞŸĞ¾Ğ·Ğ²Ğ¾Ğ»ÑĞµÑ‚ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ
  }

  // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ÑĞ²Ğ¾Ğ¹ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½ Ğ¸Ğ· Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ°
  @Post('from-definition/:definitionId')
  async createFromDefinition(
    @Param('definitionId') definitionId: string,
    @Body() dto: CreateTemplateDto,
    @CurrentUser() user: User,
  ) {}

  // ĞÑ†ĞµĞ½Ğ¸Ñ‚ÑŒ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½
  @Post(':id/review')
  async addReview(
    @Param('id') id: string,
    @Body() dto: AddReviewDto,
    @CurrentUser() user: User,
  ) {}
}
```

---

## 12. ĞŸÑ€Ğ°Ğ²Ğ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°

### 12.1 Ğ Ğ¾Ğ»Ğ¸ Ğ² BPMN

| Ğ Ğ¾Ğ»ÑŒ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | ĞŸÑ€Ğ°Ğ²Ğ° |
|------|----------|-------|
| **bpmn:admin** | ĞĞ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² | Ğ’ÑĞµ Ğ¿Ñ€Ğ°Ğ²Ğ° |
| **bpmn:designer** | Ğ Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ, Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ, Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹ |
| **bpmn:manager** | ĞœĞµĞ½ĞµĞ´Ğ¶ĞµÑ€ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² | ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€, Ğ·Ğ°Ğ¿ÑƒÑĞº, ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¸Ğ½ÑÑ‚Ğ°Ğ½ÑĞ°Ğ¼Ğ¸ |
| **bpmn:user** | ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ | Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°Ñ‡ |
| **bpmn:viewer** | ĞĞ°Ğ±Ğ»ÑĞ´Ğ°Ñ‚ĞµĞ»ÑŒ | Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ |

### 12.2 ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```sql
-- Ğ Ğ¾Ğ»Ğ¸ Ğ² BPMN Ğ¼Ğ¾Ğ´ÑƒĞ»Ğµ
CREATE TABLE bpmn_roles (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  workspace_id UUID NOT NULL REFERENCES workspaces(id) ON DELETE CASCADE,
  user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,

  role VARCHAR(50) NOT NULL,  -- 'admin', 'designer', 'manager', 'user', 'viewer'

  -- ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñ (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)
  process_definition_ids UUID[],  -- Ğ•ÑĞ»Ğ¸ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ¾, Ñ€Ğ¾Ğ»ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ ÑÑ‚Ğ¸Ñ… Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²

  granted_by_id UUID REFERENCES users(id),
  granted_at TIMESTAMPTZ DEFAULT NOW(),

  UNIQUE(workspace_id, user_id, role)
);

CREATE INDEX idx_bpmn_roles_workspace_user ON bpmn_roles(workspace_id, user_id);

-- Ğ“Ñ€ÑƒĞ¿Ğ¿Ñ‹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ (Ğ´Ğ»Ñ candidate groups Ğ² Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ°Ñ…)
CREATE TABLE user_groups (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  workspace_id UUID NOT NULL REFERENCES workspaces(id) ON DELETE CASCADE,

  name VARCHAR(255) NOT NULL,
  key VARCHAR(100) NOT NULL,  -- 'managers', 'finance-team'
  description TEXT,

  created_at TIMESTAMPTZ DEFAULT NOW(),

  UNIQUE(workspace_id, key)
);

CREATE TABLE user_group_members (
  group_id UUID NOT NULL REFERENCES user_groups(id) ON DELETE CASCADE,
  user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,

  added_at TIMESTAMPTZ DEFAULT NOW(),

  PRIMARY KEY(group_id, user_id)
);

CREATE INDEX idx_user_group_members_user ON user_group_members(user_id);
```

### 12.3 Backend: Guards

```typescript
// bpmn-roles.guard.ts
@Injectable()
export class BpmnRolesGuard implements CanActivate {
  constructor(
    private reflector: Reflector,
    private bpmnRolesService: BpmnRolesService,
  ) {}

  async canActivate(context: ExecutionContext): Promise<boolean> {
    const requiredRoles = this.reflector.get<string[]>('bpmn-roles', context.getHandler());
    if (!requiredRoles) {
      return true;
    }

    const request = context.switchToHttp().getRequest();
    const user = request.user;
    const workspaceId = request.params.workspaceId || request.body.workspaceId || request.query.workspaceId;

    if (!workspaceId) {
      return false;
    }

    const userRoles = await this.bpmnRolesService.getUserRoles(user.id, workspaceId);

    return requiredRoles.some(role => userRoles.includes(role));
  }
}

// Ğ”ĞµĞºĞ¾Ñ€Ğ°Ñ‚Ğ¾Ñ€
export const BpmnRoles = (...roles: string[]) => SetMetadata('bpmn-roles', roles);

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
@Controller('bpmn/definitions')
@UseGuards(JwtAuthGuard, BpmnRolesGuard)
export class BpmnDefinitionsController {
  @Post()
  @BpmnRoles('admin', 'designer')
  async create(@Body() dto: CreateDefinitionDto) {}

  @Post(':id/deploy')
  @BpmnRoles('admin', 'designer')
  async deploy(@Param('id') id: string) {}

  @Get()
  @BpmnRoles('admin', 'designer', 'manager', 'viewer')
  async findAll(@Query('workspaceId') workspaceId: string) {}
}
```

### 12.4 ĞœĞ°Ñ‚Ñ€Ğ¸Ñ†Ğ° Ğ¿Ñ€Ğ°Ğ²

| Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ | admin | designer | manager | user | viewer |
|----------|-------|----------|---------|------|--------|
| Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ | âœ… | âœ… | âŒ | âŒ | âŒ |
| Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ | âœ… | âœ… | âŒ | âŒ | âŒ |
| Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ | âœ… | âŒ | âŒ | âŒ | âŒ |
| Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ° | âœ… | âœ… | âŒ | âŒ | âŒ |
| Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¸Ğ½ÑÑ‚Ğ°Ğ½Ñ | âœ… | âœ… | âœ… | âŒ | âŒ |
| ĞÑ‚Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ¸Ğ½ÑÑ‚Ğ°Ğ½Ñ | âœ… | âŒ | âœ… | âŒ | âŒ |
| Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ | âœ… | âœ… | âœ… | âœ… | âŒ |
| ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸ | âœ… | âœ… | âœ… | âŒ | âœ… |
| Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ°Ğ¼Ğ¸ | âœ… | âŒ | âŒ | âŒ | âŒ |
| ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° ĞºĞ¾Ğ½Ğ½ĞµĞºÑ‚Ğ¾Ñ€Ğ¾Ğ² | âœ… | âœ… | âŒ | âŒ | âŒ |
| ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° SLA | âœ… | âœ… | âœ… | âŒ | âŒ |

---

## 13. AI/ML Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ

### 13.1 Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

| Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | ĞœĞ¾Ğ´ĞµĞ»ÑŒ |
|----------|----------|--------|
| **ĞšĞ»Ğ°ÑÑĞ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ** | ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ğ·Ğ°ÑĞ²ĞºĞ¸ | Text Classification |
| **ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ** | ĞŸÑ€ĞµĞ´ÑĞºĞ°Ğ·Ğ°Ğ½Ğ¸Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»Ñ | Recommendation |
| **ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ** | ĞÑ†ĞµĞ½ĞºĞ° Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ğ° | Regression |
| **SLA Prediction** | ĞŸÑ€ĞµĞ´ÑĞºĞ°Ğ·Ğ°Ğ½Ğ¸Ğµ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ | Time Series |
| **Anomaly Detection** | Ğ’Ñ‹ÑĞ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ°Ğ½Ğ¾Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² | Anomaly Detection |
| **NLP Extraction** | Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ÑÑƒÑ‰Ğ½Ğ¾ÑÑ‚ĞµĞ¹ Ğ¸Ğ· Ñ‚ĞµĞºÑÑ‚Ğ° | NER |

### 13.2 ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ML Pipeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ML Pipeline                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Feature    â”‚    â”‚   Model     â”‚    â”‚  Prediction â”‚         â”‚
â”‚  â”‚  Extraction â”‚â”€â”€â”€â–ºâ”‚   Storage   â”‚â”€â”€â”€â–ºâ”‚   Service   â”‚         â”‚
â”‚  â”‚             â”‚    â”‚  (MLflow)   â”‚    â”‚             â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚         â–²                                      â”‚                 â”‚
â”‚         â”‚                                      â–¼                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  Training   â”‚                      â”‚   Zeebe     â”‚           â”‚
â”‚  â”‚   Data      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   Worker    â”‚           â”‚
â”‚  â”‚  (history)  â”‚     feedback loop    â”‚  (ml-*)     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 13.3 ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```sql
-- ML Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸
CREATE TABLE ml_models (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  workspace_id UUID REFERENCES workspaces(id),  -- NULL = Ğ³Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ

  name VARCHAR(255) NOT NULL,
  type VARCHAR(100) NOT NULL,  -- 'classification', 'regression', 'recommendation'
  target VARCHAR(100) NOT NULL,  -- 'category', 'assignee', 'priority', 'resolution_time'

  -- Ğ’ĞµÑ€ÑĞ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
  version INT DEFAULT 1,
  is_active BOOLEAN DEFAULT false,

  -- ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ°
  metrics JSONB,  -- { "accuracy": 0.85, "f1": 0.82, "precision": 0.88 }

  -- ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ
  feature_config JSONB,  -- ĞšĞ°ĞºĞ¸Ğµ Ğ¿Ğ¾Ğ»Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ
  model_config JSONB,    -- ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸

  -- Ğ¥Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸
  model_path TEXT,  -- S3 path Ğ¸Ğ»Ğ¸ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿ÑƒÑ‚ÑŒ
  model_size_bytes BIGINT,

  trained_at TIMESTAMPTZ,
  trained_on_samples INT,

  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_ml_models_workspace ON ml_models(workspace_id);
CREATE INDEX idx_ml_models_type ON ml_models(type, target);

-- ĞŸÑ€ĞµĞ´ÑĞºĞ°Ğ·Ğ°Ğ½Ğ¸Ñ (Ğ´Ğ»Ñ feedback loop)
CREATE TABLE ml_predictions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  model_id UUID NOT NULL REFERENCES ml_models(id),
  entity_id UUID REFERENCES entities(id),

  -- Ğ’Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
  input_features JSONB NOT NULL,

  -- Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚
  prediction JSONB NOT NULL,  -- { "value": "support", "confidence": 0.92 }

  -- Feedback
  actual_value TEXT,  -- Ğ ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ (Ğ´Ğ»Ñ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ)
  was_correct BOOLEAN,
  feedback_at TIMESTAMPTZ,

  predicted_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_ml_predictions_model ON ml_predictions(model_id);
CREATE INDEX idx_ml_predictions_entity ON ml_predictions(entity_id);
```

### 13.4 Backend: MlModule

```
apps/backend/src/modules/ml/
â”œâ”€â”€ ml.module.ts
â”œâ”€â”€ ml.service.ts              # ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ ÑĞµÑ€Ğ²Ğ¸Ñ
â”œâ”€â”€ ml-training.service.ts     # ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹
â”œâ”€â”€ ml-prediction.service.ts   # ĞŸÑ€ĞµĞ´ÑĞºĞ°Ğ·Ğ°Ğ½Ğ¸Ñ
â”œâ”€â”€ ml.controller.ts
â”œâ”€â”€ workers/
â”‚   â”œâ”€â”€ ml-classify.worker.ts
â”‚   â”œâ”€â”€ ml-route.worker.ts
â”‚   â””â”€â”€ ml-predict-sla.worker.ts
â””â”€â”€ models/
    â”œâ”€â”€ text-classifier.ts
    â””â”€â”€ recommendation.ts
```

#### ml-prediction.service.ts

```typescript
@Injectable()
export class MlPredictionService {
  constructor(
    @InjectRepository(MlModel)
    private modelRepository: Repository<MlModel>,
    @InjectRepository(MlPrediction)
    private predictionRepository: Repository<MlPrediction>,
  ) {}

  /**
   * ĞšĞ»Ğ°ÑÑĞ¸Ñ„Ğ¸Ñ†Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ‚ĞµĞºÑÑ‚
   */
  async classify(
    workspaceId: string,
    target: string,
    text: string,
    additionalFeatures?: Record<string, any>,
  ): Promise<ClassificationResult> {
    // ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½ÑƒÑ Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ
    const model = await this.findActiveModel(workspaceId, 'classification', target);
    if (!model) {
      return { value: null, confidence: 0, modelFound: false };
    }

    // Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ Ñ„Ğ¸Ñ‡Ğ¸
    const features = this.extractFeatures(text, additionalFeatures, model.featureConfig);

    // ĞŸÑ€ĞµĞ´ÑĞºĞ°Ğ·Ğ°Ğ½Ğ¸Ğµ
    const prediction = await this.runPrediction(model, features);

    // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ´Ğ»Ñ feedback loop
    await this.savePrediction(model.id, features, prediction);

    return {
      value: prediction.label,
      confidence: prediction.probability,
      modelFound: true,
      modelVersion: model.version,
    };
  }

  /**
   * Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»Ñ
   */
  async recommendAssignee(
    workspaceId: string,
    entityData: {
      title: string;
      description: string;
      category?: string;
      priority?: string;
    },
  ): Promise<AssigneeRecommendation[]> {
    const model = await this.findActiveModel(workspaceId, 'recommendation', 'assignee');
    if (!model) {
      return [];
    }

    const features = this.extractFeatures(
      `${entityData.title} ${entityData.description}`,
      entityData,
      model.featureConfig,
    );

    const predictions = await this.runPrediction(model, features);

    return predictions.recommendations.map((rec: any) => ({
      userId: rec.userId,
      score: rec.score,
      reasons: rec.reasons,
    }));
  }

  /**
   * ĞŸÑ€ĞµĞ´ÑĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ²Ñ€ĞµĞ¼Ñ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ
   */
  async predictResolutionTime(
    workspaceId: string,
    entityData: {
      category?: string;
      priority?: string;
      wordCount: number;
      hasAttachments: boolean;
    },
  ): Promise<ResolutionTimePrediction> {
    const model = await this.findActiveModel(workspaceId, 'regression', 'resolution_time');
    if (!model) {
      return { estimatedMinutes: null, confidence: 0, modelFound: false };
    }

    const features = {
      ...entityData,
      dayOfWeek: new Date().getDay(),
      hourOfDay: new Date().getHours(),
    };

    const prediction = await this.runPrediction(model, features);

    return {
      estimatedMinutes: Math.round(prediction.value),
      confidence: prediction.confidence,
      modelFound: true,
      range: {
        min: Math.round(prediction.lower),
        max: Math.round(prediction.upper),
      },
    };
  }

  /**
   * Ğ—Ğ°Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ feedback Ğ´Ğ»Ñ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ñ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸
   */
  async recordFeedback(
    predictionId: string,
    actualValue: string,
  ): Promise<void> {
    const prediction = await this.predictionRepository.findOneOrFail({
      where: { id: predictionId },
    });

    await this.predictionRepository.update(predictionId, {
      actualValue,
      wasCorrect: prediction.prediction.value === actualValue,
      feedbackAt: new Date(),
    });
  }

  private async runPrediction(model: MlModel, features: Record<string, any>): Promise<any> {
    // Ğ’ Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ Ğ·Ğ´ĞµÑÑŒ Ğ±Ñ‹Ğ» Ğ±Ñ‹ Ğ²Ñ‹Ğ·Ğ¾Ğ² ML ÑĞµÑ€Ğ²Ğ¸ÑĞ° (Python/TensorFlow/PyTorch)
    // Ğ”Ğ»Ñ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ñ‚Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ rule-based fallback

    // ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ñ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğ¼ ML ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ¼:
    // const response = await fetch(`${ML_SERVICE_URL}/predict`, {
    //   method: 'POST',
    //   body: JSON.stringify({ model_id: model.id, features }),
    // });
    // return response.json();

    return this.ruleBased(model.target, features);
  }

  private ruleBased(target: string, features: Record<string, any>): any {
    // Fallback Ğ½Ğ° Ğ¿Ñ€Ğ¾ÑÑ‚Ñ‹Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°
    switch (target) {
      case 'category':
        return this.classifyByKeywords(features.text);
      case 'priority':
        return this.estimatePriority(features);
      default:
        return { value: null, confidence: 0 };
    }
  }
}
```

### 13.5 Zeebe Workers Ğ´Ğ»Ñ ML

```typescript
// ml-classify.worker.ts
zeebeClient.createWorker({
  taskType: 'ml:classify',
  taskHandler: async (job) => {
    const { text, target, workspaceId } = job.variables as any;

    const result = await this.mlPredictionService.classify(
      workspaceId,
      target,
      text,
    );

    return job.complete({
      [`predicted_${target}`]: result.value,
      [`${target}_confidence`]: result.confidence,
    });
  },
});

// ml-recommend-assignee.worker.ts
zeebeClient.createWorker({
  taskType: 'ml:recommend-assignee',
  taskHandler: async (job) => {
    const { title, description, category, workspaceId } = job.variables as any;

    const recommendations = await this.mlPredictionService.recommendAssignee(
      workspaceId,
      { title, description, category },
    );

    return job.complete({
      suggestedAssignees: recommendations.slice(0, 3),
      topAssignee: recommendations[0]?.userId || null,
    });
  },
});
```

---

## 14. ĞšÑ€Ğ¾ÑÑ-workspace Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ

### 14.1 ĞšĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ

ĞŸÑ€Ğ¾Ñ†ĞµÑÑÑ‹ Ğ¼Ğ¾Ğ³ÑƒÑ‚ ÑĞ¾Ğ·Ğ´Ğ°Ğ²Ğ°Ñ‚ÑŒ Ğ¸ ÑĞ²ÑĞ·Ñ‹Ğ²Ğ°Ñ‚ÑŒ ÑÑƒÑ‰Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¼ĞµĞ¶Ğ´Ñƒ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğ¼Ğ¸ workspace:
- Ğ—Ğ°ÑĞ²ĞºĞ° Ğ² IT Helpdesk â†’ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ·Ğ°ÑĞ²ĞºÑƒ Ğ½Ğ° Ğ·Ğ°ĞºÑƒĞ¿ĞºÑƒ Ğ² Procurement
- Ğ—Ğ°ÑĞ²ĞºĞ° Ğ½Ğ° Ğ¾Ñ‚Ğ¿ÑƒÑĞº Ğ² HR â†’ Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ¸Ñ‚ÑŒ Ğ² Project Management

### 14.2 ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```sql
-- Ğ¡Ğ²ÑĞ·Ğ¸ Ğ¼ĞµĞ¶Ğ´Ñƒ entities
CREATE TABLE entity_links (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

  source_entity_id UUID NOT NULL REFERENCES entities(id) ON DELETE CASCADE,
  target_entity_id UUID NOT NULL REFERENCES entities(id) ON DELETE CASCADE,

  link_type VARCHAR(50) NOT NULL,
  -- 'spawned' - ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¾ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ¼
  -- 'blocks' - Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒĞµÑ‚
  -- 'blocked_by' - Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾
  -- 'related' - ÑĞ²ÑĞ·Ğ°Ğ½Ğ¾
  -- 'duplicate' - Ğ´ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚
  -- 'parent' / 'child' - Ğ¸ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ

  -- ĞœĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ ÑĞ²ÑĞ·Ğ¸
  metadata JSONB DEFAULT '{}',
  -- { "createdByProcess": "uuid", "reason": "Ğ¢Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ Ğ·Ğ°ĞºÑƒĞ¿ĞºĞ°" }

  created_by_id UUID REFERENCES users(id),
  created_at TIMESTAMPTZ DEFAULT NOW(),

  UNIQUE(source_entity_id, target_entity_id, link_type)
);

CREATE INDEX idx_entity_links_source ON entity_links(source_entity_id);
CREATE INDEX idx_entity_links_target ON entity_links(target_entity_id);
CREATE INDEX idx_entity_links_type ON entity_links(link_type);

-- Ğ Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ Ğ½Ğ° ĞºÑ€Ğ¾ÑÑ-workspace Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
CREATE TABLE cross_workspace_permissions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

  source_workspace_id UUID NOT NULL REFERENCES workspaces(id) ON DELETE CASCADE,
  target_workspace_id UUID NOT NULL REFERENCES workspaces(id) ON DELETE CASCADE,

  -- Ğ Ğ°Ğ·Ñ€ĞµÑˆÑ‘Ğ½Ğ½Ñ‹Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
  can_create_entities BOOLEAN DEFAULT false,
  can_link_entities BOOLEAN DEFAULT false,
  can_read_entities BOOLEAN DEFAULT false,
  can_send_messages BOOLEAN DEFAULT false,

  -- ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñ
  allowed_entity_types TEXT[],  -- NULL = Ğ²ÑĞµ Ñ‚Ğ¸Ğ¿Ñ‹
  max_entities_per_day INT,     -- Ğ›Ğ¸Ğ¼Ğ¸Ñ‚ Ğ½Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ

  granted_by_id UUID REFERENCES users(id),
  granted_at TIMESTAMPTZ DEFAULT NOW(),

  UNIQUE(source_workspace_id, target_workspace_id)
);
```

### 14.3 Backend: Workers Ğ´Ğ»Ñ ĞºÑ€Ğ¾ÑÑ-workspace

```typescript
// create-entity.worker.ts
zeebeClient.createWorker({
  taskType: 'create-entity',
  taskHandler: async (job) => {
    const {
      targetWorkspaceId,
      title,
      description,
      priority,
      parentEntityId,
      linkType,
      metadata,
    } = job.variables as any;

    const sourceWorkspaceId = job.variables.workspaceId;

    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ
    const permission = await this.crossWorkspaceService.checkPermission(
      sourceWorkspaceId,
      targetWorkspaceId,
      'create_entity',
    );

    if (!permission.allowed) {
      return job.fail({
        errorMessage: `Cross-workspace creation not allowed: ${permission.reason}`,
        retries: 0,
      });
    }

    // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ entity Ğ² Ñ†ĞµĞ»ĞµĞ²Ğ¾Ğ¼ workspace
    const entity = await this.entityService.create({
      workspaceId: targetWorkspaceId,
      title,
      description,
      priority,
      metadata: {
        ...metadata,
        createdByProcess: job.processInstanceKey,
        sourceWorkspaceId,
        sourceEntityId: parentEntityId,
      },
    });

    // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ÑĞ²ÑĞ·ÑŒ
    if (parentEntityId) {
      await this.entityLinksService.create({
        sourceEntityId: parentEntityId,
        targetEntityId: entity.id,
        linkType: linkType || 'spawned',
        metadata: {
          createdByProcess: job.processInstanceKey,
        },
      });
    }

    return job.complete({
      createdEntityId: entity.id,
      createdInWorkspace: targetWorkspaceId,
    });
  },
});

// wait-for-linked-entity.worker.ts
zeebeClient.createWorker({
  taskType: 'wait-for-linked-entity',
  taskHandler: async (job) => {
    const { linkedEntityId, expectedStatus, timeoutMinutes } = job.variables as any;

    // ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒÑÑ Ğ½Ğ° Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ° ÑĞ²ÑĞ·Ğ°Ğ½Ğ½Ğ¾Ğ¹ entity
    // ĞšĞ¾Ğ³Ğ´Ğ° ÑÑ‚Ğ°Ñ‚ÑƒÑ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑÑ - Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ message Ğ² Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ

    await this.entityWatcherService.watch({
      entityId: linkedEntityId,
      expectedStatus,
      correlationKey: job.processInstanceKey,
      messageName: 'linked-entity-status-changed',
      timeoutMinutes: timeoutMinutes || 1440, // 24 Ñ‡Ğ°ÑĞ° Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ
    });

    // ĞĞµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ°ĞµĞ¼ job - Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ Ğ±ÑƒĞ´ĞµÑ‚ Ğ¶Ğ´Ğ°Ñ‚ÑŒ message
    return job.forward();
  },
});
```

### 14.4 Frontend: UI Ğ´Ğ»Ñ ÑĞ²ÑĞ·ĞµĞ¹

```tsx
// EntityLinks.tsx
interface EntityLinksProps {
  entityId: string;
}

export function EntityLinks({ entityId }: EntityLinksProps) {
  const { data: links, isLoading } = useEntityLinks(entityId);

  if (isLoading) return <Skeleton />;

  const groupedLinks = groupBy(links, 'linkType');

  return (
    <div className="space-y-4">
      {/* Spawned entities */}
      {groupedLinks.spawned?.length > 0 && (
        <div>
          <h4 className="text-sm font-medium text-gray-500 mb-2">
            Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ·Ğ°ÑĞ²ĞºĞ¸
          </h4>
          {groupedLinks.spawned.map(link => (
            <LinkedEntityCard key={link.id} link={link} />
          ))}
        </div>
      )}

      {/* Blocking */}
      {groupedLinks.blocked_by?.length > 0 && (
        <div>
          <h4 className="text-sm font-medium text-red-500 mb-2">
            Ğ—Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾
          </h4>
          {groupedLinks.blocked_by.map(link => (
            <LinkedEntityCard key={link.id} link={link} showStatus />
          ))}
        </div>
      )}

      {/* Related */}
      {groupedLinks.related?.length > 0 && (
        <div>
          <h4 className="text-sm font-medium text-gray-500 mb-2">
            Ğ¡Ğ²ÑĞ·Ğ°Ğ½Ğ½Ñ‹Ğµ
          </h4>
          {groupedLinks.related.map(link => (
            <LinkedEntityCard key={link.id} link={link} />
          ))}
        </div>
      )}
    </div>
  );
}
```

---

## 15. ĞŸĞ»Ğ°Ğ½ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

### 15.1 Ğ¤Ğ°Ğ·Ñ‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Roadmap: BPMN Platform                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Ğ¤Ğ°Ğ·Ğ° 1: Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹ + Human Tasks (4-5 Ğ½ĞµĞ´ĞµĞ»ÑŒ)                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚
â”‚  â€¢ Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²                                   â”‚
â”‚  â€¢ User Tasks Ñ inbox                                           â”‚
â”‚  â€¢ Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ñ„Ğ¾Ñ€Ğ¼Ñ‹                                                â”‚
â”‚  â€¢ ĞšÑ€Ğ¾ÑÑ-workspace ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ entities                            â”‚
â”‚                                                                  â”‚
â”‚  Ğ¤Ğ°Ğ·Ğ° 2: SLA + DMN (3-4 Ğ½ĞµĞ´ĞµĞ»Ğ¸)                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                 â”‚
â”‚  â€¢ SLA Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ Ğ¸ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³                                 â”‚
â”‚  â€¢ DMN Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¹                                          â”‚
â”‚  â€¢ Ğ­ÑĞºĞ°Ğ»Ğ°Ñ†Ğ¸Ñ Ğ¸ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ                                      â”‚
â”‚                                                                  â”‚
â”‚  Ğ¤Ğ°Ğ·Ğ° 3: Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ (4-5 Ğ½ĞµĞ´ĞµĞ»ÑŒ)                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                â”‚
â”‚  â€¢ Framework ĞºĞ¾Ğ½Ğ½ĞµĞºÑ‚Ğ¾Ñ€Ğ¾Ğ²                                        â”‚
â”‚  â€¢ Email, Telegram, REST ĞºĞ¾Ğ½Ğ½ĞµĞºÑ‚Ğ¾Ñ€Ñ‹                             â”‚
â”‚  â€¢ 1C Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)                                  â”‚
â”‚                                                                  â”‚
â”‚  Ğ¤Ğ°Ğ·Ğ° 4: ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° + Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½Ñ‹ (3-4 Ğ½ĞµĞ´ĞµĞ»Ğ¸)                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚  â€¢ Process mining                                               â”‚
â”‚  â€¢ Dashboards Ğ¸ Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚Ñ‹                                          â”‚
â”‚  â€¢ Ğ‘Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ° ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ¾Ğ²                                          â”‚
â”‚                                                                  â”‚
â”‚  Ğ¤Ğ°Ğ·Ğ° 5: AI/ML + ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ (4-6 Ğ½ĞµĞ´ĞµĞ»ÑŒ)                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”‚
â”‚  â€¢ ML ĞºĞ»Ğ°ÑÑĞ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ğ¸ Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸                              â”‚
â”‚  â€¢ ĞŸÑ€ĞµĞ´ÑĞºĞ°Ğ·Ğ°Ğ½Ğ¸Ğµ SLA                                             â”‚
â”‚  â€¢ ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸                               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 15.2 Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ½ Ğ¤Ğ°Ğ·Ñ‹ 1

| # | Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° | ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ | ĞÑ†ĞµĞ½ĞºĞ° | Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ |
|---|--------|-----------|--------|-------------|
| **1.1** | **Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹** | | | |
| 1.1.1 | ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ) | ğŸ”´ | 2Ñ‡ | â€” |
| 1.1.2 | TriggersService (CRUD + evaluation) | ğŸ”´ | 8Ñ‡ | 1.1.1 |
| 1.1.3 | EntityEventListener | ğŸ”´ | 4Ñ‡ | 1.1.2 |
| 1.1.4 | CronTriggerScheduler | ğŸŸ¡ | 4Ñ‡ | 1.1.2 |
| 1.1.5 | WebhookController | ğŸŸ¡ | 3Ñ‡ | 1.1.2 |
| 1.1.6 | API endpoints | ğŸ”´ | 3Ñ‡ | 1.1.2 |
| 1.1.7 | Frontend: TriggersList + Form | ğŸ”´ | 8Ñ‡ | 1.1.6 |
| 1.1.8 | Unit Ñ‚ĞµÑÑ‚Ñ‹ | ğŸ”´ | 4Ñ‡ | 1.1.2-1.1.5 |
| **1.2** | **Human Tasks** | | | |
| 1.2.1 | ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ) | ğŸ”´ | 2Ñ‡ | â€” |
| 1.2.2 | UserTasksService | ğŸ”´ | 12Ñ‡ | 1.2.1 |
| 1.2.3 | UserTasksWorker (Zeebe) | ğŸ”´ | 6Ñ‡ | 1.2.2 |
| 1.2.4 | API endpoints | ğŸ”´ | 4Ñ‡ | 1.2.2 |
| 1.2.5 | Frontend: TaskInbox | ğŸ”´ | 10Ñ‡ | 1.2.4 |
| 1.2.6 | Frontend: TaskDetail + Actions | ğŸ”´ | 8Ñ‡ | 1.2.5 |
| 1.2.7 | WebSocket ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ | ğŸŸ¡ | 3Ñ‡ | 1.2.2 |
| 1.2.8 | Unit Ñ‚ĞµÑÑ‚Ñ‹ | ğŸ”´ | 6Ñ‡ | 1.2.2-1.2.3 |
| **1.3** | **Ğ¤Ğ¾Ñ€Ğ¼Ñ‹** | | | |
| 1.3.1 | ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… FormDefinitions | ğŸŸ¡ | 2Ñ‡ | â€” |
| 1.3.2 | FormsService | ğŸŸ¡ | 4Ñ‡ | 1.3.1 |
| 1.3.3 | Frontend: DynamicForm | ğŸ”´ | 12Ñ‡ | 1.3.2 |
| 1.3.4 | Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ñ‚Ğ¸Ğ¿Ñ‹ Ğ¿Ğ¾Ğ»ĞµĞ¹ | ğŸ”´ | 8Ñ‡ | 1.3.3 |
| 1.3.5 | ĞšĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ (user-picker, file-upload) | ğŸŸ¡ | 6Ñ‡ | 1.3.4 |
| **1.4** | **ĞšÑ€Ğ¾ÑÑ-workspace** | | | |
| 1.4.1 | ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… entity_links | ğŸ”´ | 2Ñ‡ | â€” |
| 1.4.2 | EntityLinksService | ğŸ”´ | 4Ñ‡ | 1.4.1 |
| 1.4.3 | CrossWorkspaceService | ğŸ”´ | 4Ñ‡ | 1.4.1 |
| 1.4.4 | create-entity worker | ğŸ”´ | 4Ñ‡ | 1.4.2, 1.4.3 |
| 1.4.5 | Frontend: EntityLinks | ğŸŸ¡ | 4Ñ‡ | 1.4.2 |
| 1.4.6 | Unit Ñ‚ĞµÑÑ‚Ñ‹ | ğŸ”´ | 4Ñ‡ | 1.4.2-1.4.4 |

**Ğ˜Ñ‚Ğ¾Ğ³Ğ¾ Ğ¤Ğ°Ğ·Ğ° 1:** ~130 Ñ‡Ğ°ÑĞ¾Ğ² (4-5 Ğ½ĞµĞ´ĞµĞ»ÑŒ Ğ¿Ñ€Ğ¸ 1 Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞµ)

### 15.3 ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ñ‹ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Priority Matrix                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚         High Impact                     Low Impact               â”‚
â”‚              â”‚                              â”‚                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â”‚ Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹ â”‚ Human    â”‚      â”‚ Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½Ñ‹   â”‚ Process   â”‚        â”‚
â”‚   â”‚          â”‚ Tasks    â”‚      â”‚           â”‚ Mining    â”‚        â”‚
â”‚   â”‚          â”‚          â”‚      â”‚           â”‚           â”‚ High   â”‚
â”‚   â”‚ SLA      â”‚ Ğ¤Ğ¾Ñ€Ğ¼Ñ‹    â”‚      â”‚ ML        â”‚ DMN       â”‚ Effort â”‚
â”‚   â”‚          â”‚          â”‚      â”‚           â”‚           â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚              â”‚                              â”‚                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â”‚ Cross-   â”‚ ĞšĞ¾Ğ½Ğ½ĞµĞº-  â”‚      â”‚ Ğ’ĞµÑ€ÑĞ¸Ğ¾Ğ½Ğ¸- â”‚ ĞšĞ¾Ğ¼Ğ¿ĞµĞ½-   â”‚        â”‚
â”‚   â”‚ workspaceâ”‚ Ñ‚Ğ¾Ñ€Ñ‹     â”‚      â”‚ Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ   â”‚ ÑĞ°Ñ†Ğ¸Ğ¸     â”‚        â”‚
â”‚   â”‚          â”‚ (Email,  â”‚      â”‚           â”‚           â”‚ Low    â”‚
â”‚   â”‚ ĞŸÑ€Ğ°Ğ²Ğ°    â”‚ Telegram)â”‚      â”‚ ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° â”‚           â”‚ Effort â”‚
â”‚   â”‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°  â”‚          â”‚      â”‚           â”‚           â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                  â”‚
â”‚         Must Have              Nice to Have                      â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 15.4 Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¼Ğ¾Ğ´ÑƒĞ»ÑĞ¼Ğ¸

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Triggers  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼            â–¼            â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  Human    â”‚ â”‚   SLA     â”‚ â”‚   Cross-  â”‚
       â”‚  Tasks    â”‚ â”‚           â”‚ â”‚  workspaceâ”‚
       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
             â”‚             â”‚             â”‚
             â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                    â–¼             â–¼
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚   Forms   â”‚ â”‚ Connectorsâ”‚
             â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                   â”‚             â”‚
                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                          â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚    DMN    â”‚
                   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                         â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â–¼            â–¼            â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ Analytics â”‚ â”‚ Templates â”‚ â”‚   AI/ML   â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 15.5 Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğº Ñ€ĞµÑÑƒÑ€ÑĞ°Ğ¼

| Ğ¤Ğ°Ğ·Ğ° | Backend | Frontend | DevOps | Ğ’ÑĞµĞ³Ğ¾ |
|------|---------|----------|--------|-------|
| Ğ¤Ğ°Ğ·Ğ° 1 | 80Ñ‡ | 50Ñ‡ | â€” | 130Ñ‡ |
| Ğ¤Ğ°Ğ·Ğ° 2 | 50Ñ‡ | 30Ñ‡ | â€” | 80Ñ‡ |
| Ğ¤Ğ°Ğ·Ğ° 3 | 60Ñ‡ | 20Ñ‡ | 10Ñ‡ | 90Ñ‡ |
| Ğ¤Ğ°Ğ·Ğ° 4 | 40Ñ‡ | 40Ñ‡ | â€” | 80Ñ‡ |
| Ğ¤Ğ°Ğ·Ğ° 5 | 60Ñ‡ | 30Ñ‡ | 10Ñ‡ | 100Ñ‡ |
| **Ğ˜Ñ‚Ğ¾Ğ³Ğ¾** | **290Ñ‡** | **170Ñ‡** | **20Ñ‡** | **480Ñ‡** |

ĞŸÑ€Ğ¸ 1 full-stack Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞµ (~40Ñ‡/Ğ½ĞµĞ´ĞµĞ»Ñ): **~12 Ğ½ĞµĞ´ĞµĞ»ÑŒ (3 Ğ¼ĞµÑÑÑ†Ğ°)**
ĞŸÑ€Ğ¸ 2 Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ°Ñ…: **~6-7 Ğ½ĞµĞ´ĞµĞ»ÑŒ**

---

## Ğ—Ğ°ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ

Ğ­Ñ‚Ğ¾Ñ‚ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ Ğ¾Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ Ğ¿Ğ¾Ğ»Ğ½ÑƒÑ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñƒ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ñ BPMN-Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ñ‹. ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹:

1. **ĞœĞ¾Ğ´ÑƒĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ** â€” ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ» Ğ½ĞµĞ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼
2. **Ğ˜Ğ½ĞºÑ€ĞµĞ¼ĞµĞ½Ñ‚Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ** â€” Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ²Ğ½ĞµĞ´Ñ€ÑÑ‚ÑŒ Ğ¿Ğ¾ Ñ‡Ğ°ÑÑ‚ÑĞ¼
3. **ĞĞ±Ñ€Ğ°Ñ‚Ğ½Ğ°Ñ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ** â€” Ğ½Ğ¾Ğ²Ğ¾Ğµ Ğ½Ğµ Ğ»Ğ¾Ğ¼Ğ°ĞµÑ‚ ÑÑ‚Ğ°Ñ€Ğ¾Ğµ
4. **Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ** â€” ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ Ğ¿Ğ¾ĞºÑ€Ñ‹Ñ‚ Ñ‚ĞµÑÑ‚Ğ°Ğ¼Ğ¸

Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ñ‹Ğ¹ Ğ¿Ğ¾Ñ€ÑĞ´Ğ¾Ğº Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸:
1. **Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹** â€” Ğ±Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
2. **Human Tasks** â€” Ğ¾ÑĞ½Ğ¾Ğ²Ğ° Ğ´Ğ»Ñ Ñ‡ĞµĞ»Ğ¾Ğ²ĞµÑ‡ĞµÑĞºĞ¸Ñ… Ğ·Ğ°Ğ´Ğ°Ñ‡
3. **ĞšÑ€Ğ¾ÑÑ-workspace** â€” ÑĞ²ÑĞ·Ğ¸ Ğ¼ĞµĞ¶Ğ´Ñƒ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°Ğ¼Ğ¸
4. **SLA** â€” ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ ÑÑ€Ğ¾ĞºĞ¾Ğ²
5. **ĞÑÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ** â€” Ğ¿Ğ¾ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ñƒ Ğ±Ğ¸Ğ·Ğ½ĞµÑĞ°

---

**Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ ÑĞ¾Ğ·Ğ´Ğ°Ğ½:** Claude Code
**Ğ’ĞµÑ€ÑĞ¸Ñ:** 1.0
**Ğ”Ğ°Ñ‚Ğ°:** 2026-02-04
